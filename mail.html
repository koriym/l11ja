
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://github.com/koriym/laravel11-ja/mail.html">
      
      
        <link rel="prev" href="localization.html">
      
      
        <link rel="next" href="notifications.html">
      
      
      <link rel="icon" href="assets/images/favicon_io/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.35">
    
    
      
        <title>メール - L11JA</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.35f28582.min.css">
      
      


    
    

    

    
      <link rel="stylesheet" href="assets/css/php.css">
    
      <link rel="stylesheet" href="assets/css/mkdocs_material_extra.css">
    
      <link rel="stylesheet" href="assets/css/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-G60CEHXLQ1"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-G60CEHXLQ1",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-G60CEHXLQ1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    

  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!-- Determine classes -->



<!-- Header -->
<header class="md-header" data-md-component="header">
  <nav
          class="md-header__inner md-grid"
          aria-label="Header"
  >

    <!-- Link to home -->
    <a
            href="."
            title="L11JA"
            class="md-header__button md-logo"
            aria-label="L11JA"
            data-md-component="logo"
    >
      
  <img src="assets/images/logo.png" alt="logo">

    </a>

    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            <span style="font-family: 'Noto Sans'; font-size: 20px" >
            L11JA
            </span>
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            <span style="font-family: 'Noto Sans Batak'; font-size: 20px" >
            
              メール
            
            </span>
          </span>
        </div>
      </div>
    </div>

    <!-- Color palette toggle -->
    

    <!-- User preference: color palette -->
    
    <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    

    <!-- Site language selector -->
    

    <!-- Button to open search modal -->
    
    <label class="md-header__button md-icon" for="__search">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
    </label>

    <!-- Search interface -->
    <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <!-- Repository information -->
    
    <div class="md-header__source">
      

<!--
  Check whether the repository is hosted on one of the supported code hosting
  platforms (GitHub, GitLab or Bitbucket) to show icon.
-->


  


<!-- Repository containing source -->
<a href="https://github.com/koriym/l11ja" title="source.link.title"
    class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg width="24" height="24" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z" fill="#000"/></svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
    
  </nav>

  <!-- Navigation tabs (sticky) -->
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="releases.html" class="md-tabs__link">
          
  
  プロローグ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="installation.html" class="md-tabs__link">
          
  
  はじめに

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="lifecycle.html" class="md-tabs__link">
          
  
  アーキテクチャ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="routing.html" class="md-tabs__link">
          
  
  基本

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="artisan.html" class="md-tabs__link">
          
  
  掘り下げる

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="authentication.html" class="md-tabs__link">
          
  
  セキュリティ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="database.html" class="md-tabs__link">
          
  
  データベース

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="eloquent.html" class="md-tabs__link">
          
  
  Eloquent ORM

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="testing.html" class="md-tabs__link">
          
  
  テスト

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="starter-kits.html" class="md-tabs__link">
          
  
  パッケージ

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="L11JA" class="md-nav__button md-logo" aria-label="L11JA" data-md-component="logo">
      
  <img src="assets/images/logo.png" alt="logo">

    </a>
    L11JA
  </label>
  
    <div class="md-nav__source">
      

<!--
  Check whether the repository is hosted on one of the supported code hosting
  platforms (GitHub, GitLab or Bitbucket) to show icon.
-->


  


<!-- Repository containing source -->
<a href="https://github.com/koriym/l11ja" title="source.link.title"
    class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg width="24" height="24" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z" fill="#000"/></svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    プロローグ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            プロローグ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="releases.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    リリースノート
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="upgrade.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    アップグレードガイド
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="contributions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    貢献ガイド
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    はじめに
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            はじめに
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="installation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    インストール
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="configuration.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    設定
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="structure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ディレクトリ構造
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="frontend.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    フロントエンド
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="starter-kits.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    スターターキット
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="deployment.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    デプロイ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    アーキテクチャ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            アーキテクチャ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lifecycle.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    リクエストライフサイクル
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="container.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    サービスコンテナ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="providers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    サービスプロバイダ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="facades.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ファサード
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    基本
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            基本
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="routing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ルーティング
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="middleware.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ミドルウェア
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="csrf.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSRF保護
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="controllers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    コントローラ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="requests.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    リクエスト
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="responses.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    レスポンス
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="views.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ビュー
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="blade.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bladeテンプレート
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="vite.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    アセットバンドル
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="urls.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    URL生成
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="session.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    セッション
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="validation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    バリデーション
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="errors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    エラー処理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="logging.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ログ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    掘り下げる
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            掘り下げる
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="artisan.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Artisanコンソール
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="broadcasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ブロードキャスティング
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cache.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    キャッシュ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="collections.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    コレクション
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="concurrency.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    並行処理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="context.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    コンテキスト
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="contracts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    コントラクト
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="events.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    イベント
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="filesystem.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ファイルストレージ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="helpers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ヘルパー
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="http-client.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTPクライアント
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="localization.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ローカライゼーション
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    メール
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="mail.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    メール
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      はじめに
    </span>
  </a>
  
    <nav class="md-nav" aria-label="はじめに">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      設定
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      ドライバ/トランスポートの前提条件
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ドライバ/トランスポートの前提条件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mailgun" class="md-nav__link">
    <span class="md-ellipsis">
      Mailgunドライバ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postmark" class="md-nav__link">
    <span class="md-ellipsis">
      Postmarkドライバ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resend" class="md-nav__link">
    <span class="md-ellipsis">
      Resendドライバ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ses" class="md-nav__link">
    <span class="md-ellipsis">
      SESドライバ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mailersend" class="md-nav__link">
    <span class="md-ellipsis">
      MailerSendドライバ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      フェイルオーバー設定
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      ラウンドロビン設定
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mailable" class="md-nav__link">
    <span class="md-ellipsis">
      Mailableの生成
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mailable_1" class="md-nav__link">
    <span class="md-ellipsis">
      Mailableの記述
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mailableの記述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      送信者の設定
    </span>
  </a>
  
    <nav class="md-nav" aria-label="送信者の設定">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envelope" class="md-nav__link">
    <span class="md-ellipsis">
      Envelopeの使用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from" class="md-nav__link">
    <span class="md-ellipsis">
      グローバルな from アドレスの使用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      ビューの設定
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ビューの設定">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      プレーンテキストメール
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      ビューデータ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ビューデータ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      パブリックプロパティ経由
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with" class="md-nav__link">
    <span class="md-ellipsis">
      with パラメータ経由
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      添付ファイル
    </span>
  </a>
  
    <nav class="md-nav" aria-label="添付ファイル">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      ディスクからのファイル添付
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      生データの添付
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      インライン添付
    </span>
  </a>
  
    <nav class="md-nav" aria-label="インライン添付">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      生データ添付の埋め込み
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      添付可能なオブジェクト
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      ヘッダー
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      タグとメタデータ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symfony" class="md-nav__link">
    <span class="md-ellipsis">
      Symfonyメッセージのカスタマイズ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#markdown" class="md-nav__link">
    <span class="md-ellipsis">
      Markdownメール
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Markdownメール">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#markdown-mailables" class="md-nav__link">
    <span class="md-ellipsis">
      Markdown Mailablesの生成
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#markdown_1" class="md-nav__link">
    <span class="md-ellipsis">
      Markdownメッセージの記述
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Markdownメッセージの記述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      ボタンコンポーネント
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      パネルコンポーネント
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      テーブルコンポーネント
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      コンポーネントのカスタマイズ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コンポーネントのカスタマイズ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#css" class="md-nav__link">
    <span class="md-ellipsis">
      CSSのカスタマイズ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      メールの送信
    </span>
  </a>
  
    <nav class="md-nav" aria-label="メールの送信">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      受信者をループで処理する
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      特定のメーラー経由でメールを送信する
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      メールのキューイング
    </span>
  </a>
  
    <nav class="md-nav" aria-label="メールのキューイング">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      メールメッセージのキューイング
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      遅延メッセージキューイング
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      特定のキューにプッシュする
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      デフォルトでキューイングする
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mailables" class="md-nav__link">
    <span class="md-ellipsis">
      キューに入れられたMailablesとデータベーストランザクション
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      メールのレンダリング
    </span>
  </a>
  
    <nav class="md-nav" aria-label="メールのレンダリング">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      ブラウザでのメールのプレビュー
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      メールのローカライズ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="メールのローカライズ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      ユーザーの優先ロケール
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      テスト
    </span>
  </a>
  
    <nav class="md-nav" aria-label="テスト">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    <span class="md-ellipsis">
      メールの内容のテスト
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    <span class="md-ellipsis">
      メールの送信のテスト
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    <span class="md-ellipsis">
      メールとローカル開発
    </span>
  </a>
  
    <nav class="md-nav" aria-label="メールとローカル開発">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    <span class="md-ellipsis">
      ログドライバ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helo-mailtrap-mailpit" class="md-nav__link">
    <span class="md-ellipsis">
      HELO / Mailtrap / Mailpit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to" class="md-nav__link">
    <span class="md-ellipsis">
      グローバルなtoアドレスの使用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    <span class="md-ellipsis">
      イベント
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    <span class="md-ellipsis">
      カスタムトランスポート
    </span>
  </a>
  
    <nav class="md-nav" aria-label="カスタムトランスポート">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#symfony_1" class="md-nav__link">
    <span class="md-ellipsis">
      追加のSymfonyトランスポート
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="notifications.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    通知
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="packages.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    パッケージ開発
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="processes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    プロセス
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="queues.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    キュー
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="rate-limiting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    レート制限
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="strings.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    文字列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="scheduling.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    タスクスケジューリング
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    セキュリティ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            セキュリティ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="authentication.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    認証
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="authorization.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    認可
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="verification.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    メール確認
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="encryption.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    暗号化
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="hashing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ハッシュ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="passwords.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    パスワードリセット
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    データベース
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            データベース
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="database.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    はじめに
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="queries.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    クエリビルダ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="pagination.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ページネーション
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="migrations.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    マイグレーション
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="seeding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    シーディング
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="redis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Eloquent ORM
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Eloquent ORM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="eloquent.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    はじめに
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="eloquent-relationships.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    リレーションシップ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="eloquent-collections.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    コレクション
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="eloquent-mutators.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ミューテータ / キャスト
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="eloquent-resources.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APIリソース
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="eloquent-serialization.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    シリアライゼーション
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="eloquent-factories.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ファクトリ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    テスト
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            テスト
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="testing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    はじめに
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="http-tests.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTPテスト
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="console-tests.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    コンソールテスト
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dusk.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ブラウザテスト
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="database-testing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    データベース
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="mocking.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    モック
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    パッケージ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            パッケージ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="starter-kits.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    スターターキット
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="billing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cashier (Stripe)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cashier-paddle.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cashier (Paddle)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dusk.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ブラウザテスト
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="envoy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Envoy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="fortify.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fortify
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="folio.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Folio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="homestead.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Homestead
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="horizon.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Horizon
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="mix.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mix
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="octane.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Octane
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="passport.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Passport
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="pennant.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pennant
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="pint.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="precognition.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Precognition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="prompts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prompts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="pulse.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pulse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reverb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reverb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="sail.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sail
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="sanctum.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sanctum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="scout.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scout
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="socialite.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Socialite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="telescope.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Telescope
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="valet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Valet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      はじめに
    </span>
  </a>
  
    <nav class="md-nav" aria-label="はじめに">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      設定
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      ドライバ/トランスポートの前提条件
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ドライバ/トランスポートの前提条件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mailgun" class="md-nav__link">
    <span class="md-ellipsis">
      Mailgunドライバ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postmark" class="md-nav__link">
    <span class="md-ellipsis">
      Postmarkドライバ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resend" class="md-nav__link">
    <span class="md-ellipsis">
      Resendドライバ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ses" class="md-nav__link">
    <span class="md-ellipsis">
      SESドライバ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mailersend" class="md-nav__link">
    <span class="md-ellipsis">
      MailerSendドライバ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      フェイルオーバー設定
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      ラウンドロビン設定
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mailable" class="md-nav__link">
    <span class="md-ellipsis">
      Mailableの生成
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mailable_1" class="md-nav__link">
    <span class="md-ellipsis">
      Mailableの記述
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mailableの記述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      送信者の設定
    </span>
  </a>
  
    <nav class="md-nav" aria-label="送信者の設定">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#envelope" class="md-nav__link">
    <span class="md-ellipsis">
      Envelopeの使用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from" class="md-nav__link">
    <span class="md-ellipsis">
      グローバルな from アドレスの使用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      ビューの設定
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ビューの設定">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      プレーンテキストメール
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      ビューデータ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ビューデータ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      パブリックプロパティ経由
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with" class="md-nav__link">
    <span class="md-ellipsis">
      with パラメータ経由
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      添付ファイル
    </span>
  </a>
  
    <nav class="md-nav" aria-label="添付ファイル">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      ディスクからのファイル添付
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      生データの添付
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      インライン添付
    </span>
  </a>
  
    <nav class="md-nav" aria-label="インライン添付">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      生データ添付の埋め込み
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      添付可能なオブジェクト
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      ヘッダー
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      タグとメタデータ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symfony" class="md-nav__link">
    <span class="md-ellipsis">
      Symfonyメッセージのカスタマイズ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#markdown" class="md-nav__link">
    <span class="md-ellipsis">
      Markdownメール
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Markdownメール">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#markdown-mailables" class="md-nav__link">
    <span class="md-ellipsis">
      Markdown Mailablesの生成
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#markdown_1" class="md-nav__link">
    <span class="md-ellipsis">
      Markdownメッセージの記述
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Markdownメッセージの記述">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      ボタンコンポーネント
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      パネルコンポーネント
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      テーブルコンポーネント
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      コンポーネントのカスタマイズ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コンポーネントのカスタマイズ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#css" class="md-nav__link">
    <span class="md-ellipsis">
      CSSのカスタマイズ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      メールの送信
    </span>
  </a>
  
    <nav class="md-nav" aria-label="メールの送信">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      受信者をループで処理する
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      特定のメーラー経由でメールを送信する
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      メールのキューイング
    </span>
  </a>
  
    <nav class="md-nav" aria-label="メールのキューイング">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      メールメッセージのキューイング
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      遅延メッセージキューイング
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      特定のキューにプッシュする
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      デフォルトでキューイングする
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mailables" class="md-nav__link">
    <span class="md-ellipsis">
      キューに入れられたMailablesとデータベーストランザクション
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      メールのレンダリング
    </span>
  </a>
  
    <nav class="md-nav" aria-label="メールのレンダリング">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      ブラウザでのメールのプレビュー
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      メールのローカライズ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="メールのローカライズ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      ユーザーの優先ロケール
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      テスト
    </span>
  </a>
  
    <nav class="md-nav" aria-label="テスト">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    <span class="md-ellipsis">
      メールの内容のテスト
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    <span class="md-ellipsis">
      メールの送信のテスト
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    <span class="md-ellipsis">
      メールとローカル開発
    </span>
  </a>
  
    <nav class="md-nav" aria-label="メールとローカル開発">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    <span class="md-ellipsis">
      ログドライバ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helo-mailtrap-mailpit" class="md-nav__link">
    <span class="md-ellipsis">
      HELO / Mailtrap / Mailpit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to" class="md-nav__link">
    <span class="md-ellipsis">
      グローバルなtoアドレスの使用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    <span class="md-ellipsis">
      イベント
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    <span class="md-ellipsis">
      カスタムトランスポート
    </span>
  </a>
  
    <nav class="md-nav" aria-label="カスタムトランスポート">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#symfony_1" class="md-nav__link">
    <span class="md-ellipsis">
      追加のSymfonyトランスポート
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/koriym/l11ja/edit/11.x-ja/mail.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="_1">メール<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="#introduction">はじめに</a><ul>
<li><a href="#configuration">設定</a></li>
<li><a href="#driver-prerequisites">ドライバの前提条件</a></li>
<li><a href="#failover-configuration">フェイルオーバー設定</a></li>
<li><a href="#round-robin-configuration">ラウンドロビン設定</a></li>
</ul>
</li>
<li><a href="#generating-mailables">メールブル生成</a></li>
<li><a href="#writing-mailables">メールブルの記述</a><ul>
<li><a href="#configuring-the-sender">送信者の設定</a></li>
<li><a href="#configuring-the-view">ビューの設定</a></li>
<li><a href="#view-data">ビューデータ</a></li>
<li><a href="#attachments">添付ファイル</a></li>
<li><a href="#inline-attachments">インライン添付ファイル</a></li>
<li><a href="#attachable-objects">添付可能なオブジェクト</a></li>
<li><a href="#headers">ヘッダー</a></li>
<li><a href="#tags-and-metadata">タグとメタデータ</a></li>
<li><a href="#customizing-the-symfony-message">Symfonyメッセージのカスタマイズ</a></li>
</ul>
</li>
<li><a href="#markdown-mailables">Markdownメールブル</a><ul>
<li><a href="#generating-markdown-mailables">Markdownメールブルの生成</a></li>
<li><a href="#writing-markdown-messages">Markdownメッセージの記述</a></li>
<li><a href="#customizing-the-components">コンポーネントのカスタマイズ</a></li>
</ul>
</li>
<li><a href="#sending-mail">メールの送信</a><ul>
<li><a href="#queueing-mail">メールのキューイング</a></li>
</ul>
</li>
<li><a href="#rendering-mailables">メールブルのレンダリング</a><ul>
<li><a href="#previewing-mailables-in-the-browser">ブラウザでのメールブルのプレビュー</a></li>
</ul>
</li>
<li><a href="#localizing-mailables">メールブルのローカライズ</a></li>
<li><a href="#testing-mailables">テスト</a><ul>
<li><a href="#testing-mailable-content">メールブルの内容のテスト</a></li>
<li><a href="#testing-mailable-sending">メールブルの送信のテスト</a></li>
</ul>
</li>
<li><a href="#mail-and-local-development">メールとローカル開発</a></li>
<li><a href="#events">イベント</a></li>
<li><a href="#custom-transports">カスタムトランスポート</a><ul>
<li><a href="#additional-symfony-transports">追加のSymfonyトランスポート</a></li>
</ul>
</li>
</ul>
<p><a name="introduction"></a></p>
<h2 id="_2">はじめに<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>メールの送信は、必ずしも複雑である必要はありません。Laravelは、人気のある<a href="https://symfony.com/doc/7.0/mailer.html">Symfony Mailer</a>コンポーネントを利用した、クリーンでシンプルなメールAPIを提供します。LaravelとSymfony Mailerは、SMTP、Mailgun、Postmark、Resend、Amazon SES、<code>sendmail</code>を介してメールを送信するためのドライバを提供し、ローカルまたはクラウドベースのサービスを介してメールをすばやく送信できるようにします。</p>
<p><a name="configuration"></a></p>
<h3 id="_3">設定<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>Laravelのメールサービスは、アプリケーションの<code>config/mail.php</code>設定ファイルを介して設定できます。このファイル内で設定された各メーラーは、独自の固有の設定を持つことができ、独自の固有の「トランスポート」を持つことができます。これにより、アプリケーションは特定のメールメッセージを送信するために異なるメールサービスを使用できます。たとえば、アプリケーションはPostmarkを使用してトランザクションメールを送信し、Amazon SESを使用して一括メールを送信する場合があります。</p>
<p><code>mail</code>設定ファイル内で、<code>mailers</code>設定配列を見つけることができます。この配列には、Laravelがサポートする主要なメールドライバ/トランスポートごとにサンプル設定エントリが含まれています。一方、<code>default</code>設定値は、アプリケーションがメールメッセージを送信する必要がある場合にデフォルトで使用するメーラーを決定します。</p>
<p><a name="driver-prerequisites"></a></p>
<h3 id="_4">ドライバ/トランスポートの前提条件<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>MailgunやPostmarkなどのAPIベースのドライバは、SMTPサーバーを介してメールを送信するよりもシンプルで高速です。可能な限り、これらのドライバのいずれかを使用することをお勧めします。</p>
<p><a name="mailgun-driver"></a></p>
<h4 id="mailgun">Mailgunドライバ<a class="headerlink" href="#mailgun" title="Permanent link">&para;</a></h4>
<p>Mailgunドライバを使用するには、Composerを介してSymfonyのMailgun Mailerトランスポートをインストールします。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>composer<span class="w"> </span>require<span class="w"> </span>symfony/mailgun-mailer<span class="w"> </span>symfony/http-client
</code></pre></div>
<p>次に、アプリケーションの<code>config/mail.php</code>設定ファイルで<code>default</code>オプションを<code>mailgun</code>に設定し、<code>mailers</code>の配列に次の設定配列を追加します。</p>
<div class="highlight"><pre><span></span><code><span class="s1">&#39;mailgun&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">&#39;transport&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mailgun&#39;</span><span class="p">,</span>
    <span class="c1">// &#39;client&#39; =&gt; [</span>
    <span class="c1">//     &#39;timeout&#39; =&gt; 5,</span>
    <span class="c1">// ],</span>
<span class="p">],</span>
</code></pre></div>
<p>アプリケーションのデフォルトメーラーを設定した後、<code>config/services.php</code>設定ファイルに次のオプションを追加してください。</p>
<div class="highlight"><pre><span></span><code><span class="s1">&#39;mailgun&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">&#39;domain&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;MAILGUN_DOMAIN&#39;</span><span class="p">),</span>
    <span class="s1">&#39;secret&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;MAILGUN_SECRET&#39;</span><span class="p">),</span>
    <span class="s1">&#39;endpoint&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;MAILGUN_ENDPOINT&#39;</span><span class="p">,</span> <span class="s1">&#39;api.mailgun.net&#39;</span><span class="p">),</span>
    <span class="s1">&#39;scheme&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;https&#39;</span><span class="p">,</span>
<span class="p">],</span>
</code></pre></div>
<p>米国以外の<a href="https://documentation.mailgun.com/en/latest/api-intro.html#mailgun-regions">Mailgunリージョン</a>を使用していない場合は、<code>services</code>設定ファイルでリージョンのエンドポイントを定義できます。</p>
<div class="highlight"><pre><span></span><code><span class="s1">&#39;mailgun&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">&#39;domain&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;MAILGUN_DOMAIN&#39;</span><span class="p">),</span>
    <span class="s1">&#39;secret&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;MAILGUN_SECRET&#39;</span><span class="p">),</span>
    <span class="s1">&#39;endpoint&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;MAILGUN_ENDPOINT&#39;</span><span class="p">,</span> <span class="s1">&#39;api.eu.mailgun.net&#39;</span><span class="p">),</span>
    <span class="s1">&#39;scheme&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;https&#39;</span><span class="p">,</span>
<span class="p">],</span>
</code></pre></div>
<p><a name="postmark-driver"></a></p>
<h4 id="postmark">Postmarkドライバ<a class="headerlink" href="#postmark" title="Permanent link">&para;</a></h4>
<p><a href="https://postmarkapp.com/">Postmark</a>ドライバを使用するには、Composerを介してSymfonyのPostmark Mailerトランスポートをインストールします。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>composer<span class="w"> </span>require<span class="w"> </span>symfony/postmark-mailer<span class="w"> </span>symfony/http-client
</code></pre></div>
<p>次に、アプリケーションの<code>config/mail.php</code>設定ファイルで<code>default</code>オプションを<code>postmark</code>に設定します。アプリケーションのデフォルトメーラーを設定した後、<code>config/services.php</code>設定ファイルに次のオプションが含まれていることを確認してください。</p>
<div class="highlight"><pre><span></span><code><span class="s1">&#39;postmark&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">&#39;token&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;POSTMARK_TOKEN&#39;</span><span class="p">),</span>
<span class="p">],</span>
</code></pre></div>
<p>特定のメーラーによって使用されるべきPostmarkメッセージストリームを指定したい場合は、メーラーの設定配列に<code>message_stream_id</code>設定オプションを追加できます。この設定配列は、アプリケーションの<code>config/mail.php</code>設定ファイルにあります。</p>
<div class="highlight"><pre><span></span><code><span class="s1">&#39;postmark&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">&#39;transport&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;postmark&#39;</span><span class="p">,</span>
    <span class="s1">&#39;message_stream_id&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;POSTMARK_MESSAGE_STREAM_ID&#39;</span><span class="p">),</span>
    <span class="c1">// &#39;client&#39; =&gt; [</span>
    <span class="c1">//     &#39;timeout&#39; =&gt; 5,</span>
    <span class="c1">// ],</span>
<span class="p">],</span>
</code></pre></div>
<p>このようにして、異なるメッセージストリームを持つ複数のPostmarkメーラーを設定できます。</p>
<p><a name="resend-driver"></a></p>
<h4 id="resend">Resendドライバ<a class="headerlink" href="#resend" title="Permanent link">&para;</a></h4>
<p><a href="https://resend.com/">Resend</a>ドライバを使用するには、Composerを介してResendのPHP SDKをインストールします。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>composer<span class="w"> </span>require<span class="w"> </span>resend/resend-php
</code></pre></div>
<p>次に、アプリケーションの<code>config/mail.php</code>設定ファイルで<code>default</code>オプションを<code>resend</code>に設定します。アプリケーションのデフォルトメーラーを設定した後、<code>config/services.php</code>設定ファイルに次のオプションが含まれていることを確認してください。</p>
<div class="highlight"><pre><span></span><code><span class="s1">&#39;resend&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">&#39;key&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;RESEND_KEY&#39;</span><span class="p">),</span>
<span class="p">],</span>
</code></pre></div>
<p><a name="ses-driver"></a></p>
<h4 id="ses">SESドライバ<a class="headerlink" href="#ses" title="Permanent link">&para;</a></h4>
<p>Amazon SESドライバを使用するには、まずAmazon AWS SDK for PHPをインストールする必要があります。このライブラリは、Composerパッケージマネージャを介してインストールできます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>composer<span class="w"> </span>require<span class="w"> </span>aws/aws-sdk-php
</code></pre></div>
<p>次に、<code>config/mail.php</code>設定ファイルで<code>default</code>オプションを<code>ses</code>に設定し、<code>config/services.php</code>設定ファイルに次のオプションが含まれていることを確認してください。</p>
<div class="highlight"><pre><span></span><code><span class="s1">&#39;ses&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">&#39;key&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_ACCESS_KEY_ID&#39;</span><span class="p">),</span>
    <span class="s1">&#39;secret&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_SECRET_ACCESS_KEY&#39;</span><span class="p">),</span>
    <span class="s1">&#39;region&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_DEFAULT_REGION&#39;</span><span class="p">,</span> <span class="s1">&#39;us-east-1&#39;</span><span class="p">),</span>
<span class="p">],</span>
</code></pre></div>
<p>AWS <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_use-resources.html">一時的な認証情報</a>をセッショントークンを介して利用するには、アプリケーションのSES設定に<code>token</code>キーを追加できます。</p>
<div class="highlight"><pre><span></span><code><span class="s1">&#39;ses&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">&#39;key&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_ACCESS_KEY_ID&#39;</span><span class="p">),</span>
    <span class="s1">&#39;secret&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_SECRET_ACCESS_KEY&#39;</span><span class="p">),</span>
    <span class="s1">&#39;region&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_DEFAULT_REGION&#39;</span><span class="p">,</span> <span class="s1">&#39;us-east-1&#39;</span><span class="p">),</span>
    <span class="s1">&#39;token&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_SESSION_TOKEN&#39;</span><span class="p">),</span>
<span class="p">],</span>
</code></pre></div>
<p>SESの<a href="https://docs.aws.amazon.com/ses/latest/dg/sending-email-subscription-management.html">サブスクリプション管理機能</a>と対話するには、メールメッセージの<a href="#headers"><code>headers</code></a>メソッドによって返される配列に<code>X-Ses-List-Management-Options</code>ヘッダーを返すことができます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="sd">/**</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="sd"> * メッセージヘッダーを取得します。</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="sd"> */</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="k">public</span> <span class="k">function</span> <span class="nf">headers</span><span class="p">()</span><span class="o">:</span> <span class="nx">Headers</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="p">{</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="k">return</span> <span class="k">new</span> <span class="nx">Headers</span><span class="p">(</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>        <span class="nx">text</span><span class="o">:</span> <span class="p">[</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>            <span class="s1">&#39;X-Ses-List-Management-Options&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;contactListName=MyContactList;topicName=MyTopic&#39;</span><span class="p">,</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>        <span class="p">],</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="p">);</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="p">}</span>
</code></pre></div>
<p>Laravelがメールを送信する際にAWS SDKの<code>SendEmail</code>メソッドに渡す必要がある<a href="https://docs.aws.amazon.com/aws-sdk-php/v3/api/api-sesv2-2019-09-27.html#sendemail">追加オプション</a>を定義したい場合は、<code>ses</code>設定内に<code>options</code>配列を定義できます。</p>
<div class="highlight"><pre><span></span><code><span class="s1">&#39;ses&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">&#39;key&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_ACCESS_KEY_ID&#39;</span><span class="p">),</span>
    <span class="s1">&#39;secret&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_SECRET_ACCESS_KEY&#39;</span><span class="p">),</span>
    <span class="s1">&#39;region&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;AWS_DEFAULT_REGION&#39;</span><span class="p">,</span> <span class="s1">&#39;us-east-1&#39;</span><span class="p">),</span>
    <span class="s1">&#39;options&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">&#39;ConfigurationSetName&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;MyConfigurationSet&#39;</span><span class="p">,</span>
        <span class="s1">&#39;EmailTags&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="p">[</span><span class="s1">&#39;Name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;bar&#39;</span><span class="p">],</span>
        <span class="p">],</span>
    <span class="p">],</span>
<span class="p">],</span>
</code></pre></div>
<p><a name="mailersend-driver"></a></p>
<h4 id="mailersend">MailerSendドライバ<a class="headerlink" href="#mailersend" title="Permanent link">&para;</a></h4>
<p><a href="https://www.mailersend.com/">MailerSend</a>は、トランザクションメールとSMSサービスであり、Laravel用のAPIベースのメールドライバを独自に管理しています。ドライバを含むパッケージは、Composerパッケージマネージャを介してインストールできます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>composer<span class="w"> </span>require<span class="w"> </span>mailersend/laravel-driver
</code></pre></div>
<p>パッケージがインストールされたら、アプリケーションの<code>.env</code>ファイルに<code>MAILERSEND_API_KEY</code>環境変数を追加します。さらに、<code>MAIL_MAILER</code>環境変数を<code>mailersend</code>として定義する必要があります。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nv">MAIL_MAILER</span><span class="o">=</span>mailersend
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nv">MAIL_FROM_ADDRESS</span><span class="o">=</span>app@yourdomain.com
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="nv">MAIL_FROM_NAME</span><span class="o">=</span><span class="s2">&quot;App Name&quot;</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="nv">MAILERSEND_API_KEY</span><span class="o">=</span>your-api-key
</code></pre></div>
<p>最後に、アプリケーションの<code>config/mail.php</code>設定ファイルの<code>mailers</code>配列にMailerSendを追加します。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="s1">&#39;mailersend&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="s1">&#39;transport&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mailersend&#39;</span><span class="p">,</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="p">],</span>
</code></pre></div>
<p>MailerSendの詳細については、ホストされたテンプレートの使用方法を含め、<a href="https://github.com/mailersend/mailersend-laravel-driver#usage">MailerSendドライバのドキュメント</a>を参照してください。</p>
<p><a name="failover-configuration"></a></p>
<h3 id="_5">フェイルオーバー設定<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>場合によっては、アプリケーションのメールを送信するために設定した外部サービスがダウンすることがあります。このような場合、プライマリデリバリードライバがダウンした場合に使用される1つ以上のバックアップメール配信設定を定義すると便利です。</p>
<p>これを実現するには、アプリケーションの<code>mail</code>設定ファイル内に<code>failover</code>トランスポートを使用するメーラーを定義する必要があります。アプリケーションの<code>failover</code>メーラーの設定配列には、設定されたメーラーが配信のために選択される順序を参照する<code>mailers</code>の配列が含まれている必要があります。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>    <span class="s1">&#39;mailers&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>        <span class="s1">&#39;failover&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>            <span class="s1">&#39;transport&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;failover&#39;</span><span class="p">,</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>            <span class="s1">&#39;mailers&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>                <span class="s1">&#39;postmark&#39;</span><span class="p">,</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>                <span class="s1">&#39;mailgun&#39;</span><span class="p">,</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>                <span class="s1">&#39;sendmail&#39;</span><span class="p">,</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>            <span class="p">],</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>        <span class="p">],</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>        <span class="c1">// ...</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>    <span class="p">],</span>
</code></pre></div>
<p>フェイルオーバーメーラーを定義したら、アプリケーションの <code>mail</code> 設定ファイル内の <code>default</code> 設定キーの値としてその名前を指定することで、このメーラーをアプリケーションが使用するデフォルトのメーラーとして設定する必要があります。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>    <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;MAIL_MAILER&#39;</span><span class="p">,</span> <span class="s1">&#39;failover&#39;</span><span class="p">),</span>
</code></pre></div>
<p><a name="round-robin-configuration"></a></p>
<h3 id="_6">ラウンドロビン設定<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p><code>roundrobin</code> トランスポートを使用すると、複数のメーラー間でメーリングの負荷を分散できます。まず、<code>roundrobin</code> トランスポートを使用するメーラーをアプリケーションの <code>mail</code> 設定ファイル内で定義します。アプリケーションの <code>roundrobin</code> メーラーの設定配列には、配信に使用する設定済みのメーラーを参照する <code>mailers</code> の配列を含める必要があります。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>    <span class="s1">&#39;mailers&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>        <span class="s1">&#39;roundrobin&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>            <span class="s1">&#39;transport&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;roundrobin&#39;</span><span class="p">,</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>            <span class="s1">&#39;mailers&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>                <span class="s1">&#39;ses&#39;</span><span class="p">,</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>                <span class="s1">&#39;postmark&#39;</span><span class="p">,</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>            <span class="p">],</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>        <span class="p">],</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>        <span class="c1">// ...</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>    <span class="p">],</span>
</code></pre></div>
<p>ラウンドロビンメーラーを定義したら、アプリケーションの <code>mail</code> 設定ファイル内の <code>default</code> 設定キーの値としてその名前を指定することで、このメーラーをアプリケーションが使用するデフォルトのメーラーとして設定する必要があります。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>    <span class="s1">&#39;default&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;MAIL_MAILER&#39;</span><span class="p">,</span> <span class="s1">&#39;roundrobin&#39;</span><span class="p">),</span>
</code></pre></div>
<p>ラウンドロビントランスポートは、設定されたメーラーのリストからランダムにメーラーを選択し、後続の各メールに対して次に利用可能なメーラーに切り替えます。<code>failover</code> トランスポートが <em><a href="https://en.wikipedia.org/wiki/High_availability">高可用性</a></em> を実現するのに役立つのに対し、<code>roundrobin</code> トランスポートは <em><a href="https://en.wikipedia.org/wiki/Load_balancing_(computing)">負荷分散</a></em> を提供します。</p>
<p><a name="generating-mailables"></a></p>
<h2 id="mailable">Mailableの生成<a class="headerlink" href="#mailable" title="Permanent link">&para;</a></h2>
<p>Laravelアプリケーションを構築する際、アプリケーションによって送信される各タイプのメールは "mailable" クラスとして表されます。これらのクラスは <code>app/Mail</code> ディレクトリに保存されます。このディレクトリがアプリケーションに表示されない場合でも心配はいりません。<code>make:mail</code> Artisanコマンドを使用して最初のmailableクラスを作成すると、自動的に生成されます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>php<span class="w"> </span>artisan<span class="w"> </span>make:mail<span class="w"> </span>OrderShipped
</code></pre></div>
<p><a name="writing-mailables"></a></p>
<h2 id="mailable_1">Mailableの記述<a class="headerlink" href="#mailable_1" title="Permanent link">&para;</a></h2>
<p>mailableクラスを生成したら、それを開いて内容を確認しましょう。mailableクラスの設定は、<code>envelope</code>、<code>content</code>、<code>attachments</code> などのいくつかのメソッドで行われます。</p>
<p><code>envelope</code> メソッドは、メッセージの件名と、場合によっては受信者を定義する <code>Illuminate\Mail\Mailables\Envelope</code> オブジェクトを返します。<code>content</code> メソッドは、メッセージの内容を生成するために使用される <a href="blade.html">Bladeテンプレート</a> を定義する <code>Illuminate\Mail\Mailables\Content</code> オブジェクトを返します。</p>
<p><a name="configuring-the-sender"></a></p>
<h3 id="_7">送信者の設定<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p><a name="using-the-envelope"></a></p>
<h4 id="envelope">Envelopeの使用<a class="headerlink" href="#envelope" title="Permanent link">&para;</a></h4>
<p>まず、メールの送信者を設定する方法を見てみましょう。つまり、メールが「誰から」送信されるかです。送信者を設定する方法は2つあります。まず、メッセージのenvelopeに「from」アドレスを指定することができます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">use</span> <span class="nx">Illuminate\Mail\Mailables\Address</span><span class="p">;</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="k">use</span> <span class="nx">Illuminate\Mail\Mailables\Envelope</span><span class="p">;</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="sd">/**</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="sd"> * メッセージのenvelopeを取得します。</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="sd"> */</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="k">public</span> <span class="k">function</span> <span class="nf">envelope</span><span class="p">()</span><span class="o">:</span> <span class="nx">Envelope</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="p">{</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>    <span class="k">return</span> <span class="k">new</span> <span class="nx">Envelope</span><span class="p">(</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>        <span class="nx">from</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Address</span><span class="p">(</span><span class="s1">&#39;jeffrey@example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;Jeffrey Way&#39;</span><span class="p">),</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>        <span class="nx">subject</span><span class="o">:</span> <span class="s1">&#39;Order Shipped&#39;</span><span class="p">,</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>    <span class="p">);</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="p">}</span>
</code></pre></div>
<p>必要に応じて、<code>replyTo</code> アドレスを指定することもできます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">return</span> <span class="k">new</span> <span class="nx">Envelope</span><span class="p">(</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>    <span class="nx">from</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Address</span><span class="p">(</span><span class="s1">&#39;jeffrey@example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;Jeffrey Way&#39;</span><span class="p">),</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>    <span class="nx">replyTo</span><span class="o">:</span> <span class="p">[</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>        <span class="k">new</span> <span class="nx">Address</span><span class="p">(</span><span class="s1">&#39;taylor@example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;Taylor Otwell&#39;</span><span class="p">),</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>    <span class="p">],</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>    <span class="nx">subject</span><span class="o">:</span> <span class="s1">&#39;Order Shipped&#39;</span><span class="p">,</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="p">);</span>
</code></pre></div>
<p><a name="using-a-global-from-address"></a></p>
<h4 id="from">グローバルな <code>from</code> アドレスの使用<a class="headerlink" href="#from" title="Permanent link">&para;</a></h4>
<p>ただし、アプリケーションがすべてのメールに同じ「from」アドレスを使用している場合、生成する各mailableクラスにそれを追加するのは面倒になる可能性があります。代わりに、<code>config/mail.php</code> 設定ファイルでグローバルな「from」アドレスを指定することができます。mailableクラス内で他の「from」アドレスが指定されていない場合、このアドレスが使用されます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="s1">&#39;from&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>    <span class="s1">&#39;address&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;MAIL_FROM_ADDRESS&#39;</span><span class="p">,</span> <span class="s1">&#39;hello@example.com&#39;</span><span class="p">),</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>    <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nx">env</span><span class="p">(</span><span class="s1">&#39;MAIL_FROM_NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;Example&#39;</span><span class="p">),</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="p">],</span>
</code></pre></div>
<p>さらに、<code>config/mail.php</code> 設定ファイル内でグローバルな「reply_to」アドレスを定義することもできます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="s1">&#39;reply_to&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;address&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;example@example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;App Name&#39;</span><span class="p">],</span>
</code></pre></div>
<p><a name="configuring-the-view"></a></p>
<h3 id="_8">ビューの設定<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>mailableクラスの <code>content</code> メソッド内で、<code>view</code> を定義するか、メールの内容をレンダリングする際に使用するテンプレートを指定します。各メールは通常、その内容をレンダリングするために <a href="blade.html">Bladeテンプレート</a> を使用するため、メールのHTMLを構築する際にBladeテンプレートエンジンのパワーと利便性をフルに活用できます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="sd">/**</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="sd"> * メッセージの内容定義を取得します。</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="sd"> */</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="k">public</span> <span class="k">function</span> <span class="nf">content</span><span class="p">()</span><span class="o">:</span> <span class="nx">Content</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="p">{</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>    <span class="k">return</span> <span class="k">new</span> <span class="nx">Content</span><span class="p">(</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>        <span class="nx">view</span><span class="o">:</span> <span class="s1">&#39;mail.orders.shipped&#39;</span><span class="p">,</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>    <span class="p">);</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="p">}</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>すべてのメールテンプレートを格納するために <code>resources/views/emails</code> ディレクトリを作成することをお勧めします。ただし、<code>resources/views</code> ディレクトリ内の好きな場所に配置することができます。</p>
</div>
<p><a name="plain-text-emails"></a></p>
<h4 id="_9">プレーンテキストメール<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<p>メールのプレーンテキストバージョンを定義したい場合は、メッセージの <code>Content</code> 定義を作成する際にプレーンテキストテンプレートを指定できます。<code>view</code> パラメータと同様に、<code>text</code> パラメータはメールの内容をレンダリングするために使用されるテンプレート名である必要があります。HTMLとプレーンテキストの両方のバージョンのメッセージを自由に定義できます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="sd">/**</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="sd"> * メッセージの内容定義を取得します。</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="sd"> */</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="k">public</span> <span class="k">function</span> <span class="nf">content</span><span class="p">()</span><span class="o">:</span> <span class="nx">Content</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="p">{</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>    <span class="k">return</span> <span class="k">new</span> <span class="nx">Content</span><span class="p">(</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>        <span class="nx">view</span><span class="o">:</span> <span class="s1">&#39;mail.orders.shipped&#39;</span><span class="p">,</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>        <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;mail.orders.shipped-text&#39;</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>    <span class="p">);</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="p">}</span>
</code></pre></div>
<p>明確にするために、<code>html</code> パラメータを <code>view</code> パラメータのエイリアスとして使用できます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="k">return</span> <span class="k">new</span> <span class="nx">Content</span><span class="p">(</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>    <span class="nx">html</span><span class="o">:</span> <span class="s1">&#39;mail.orders.shipped&#39;</span><span class="p">,</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>    <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;mail.orders.shipped-text&#39;</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="p">);</span>
</code></pre></div>
<p><a name="view-data"></a></p>
<h3 id="_10">ビューデータ<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p><a name="via-public-properties"></a></p>
<h4 id="_11">パブリックプロパティ経由<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<p>通常、メールのHTMLをレンダリングする際に使用できるように、ビューにいくつかのデータを渡したいと思うでしょう。データをビューで利用できるようにする方法は2つあります。まず、mailableクラスで定義されたパブリックプロパティは自動的にビューで利用できるようになります。したがって、たとえば、データをmailableクラスのコンストラクタに渡し、そのデータをクラスで定義されたパブリックプロパティに設定できます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="o">&lt;?</span><span class="nx">php</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="k">namespace</span> <span class="nx">App\Mail</span><span class="p">;</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="k">use</span> <span class="nx">App\Models\Order</span><span class="p">;</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="k">use</span> <span class="nx">Illuminate\Bus\Queueable</span><span class="p">;</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="k">use</span> <span class="nx">Illuminate\Mail\Mailable</span><span class="p">;</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="k">use</span> <span class="nx">Illuminate\Mail\Mailables\Content</span><span class="p">;</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="k">use</span> <span class="nx">Illuminate\Queue\SerializesModels</span><span class="p">;</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="k">class</span> <span class="nc">OrderShipped</span> <span class="k">extends</span> <span class="nx">Mailable</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="p">{</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>    <span class="k">use</span> <span class="nx">Queueable</span><span class="p">,</span> <span class="nx">SerializesModels</span><span class="p">;</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>    <span class="sd">/**</span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="sd">     * 新しいメッセージインスタンスを作成します。</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="sd">     */</span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>        <span class="k">public</span> <span class="nx">Order</span> <span class="nv">$order</span><span class="p">,</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>    <span class="p">)</span> <span class="p">{}</span>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>    <span class="sd">/**</span>
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a><span class="sd">     * メッセージの内容定義を取得します。</span>
<a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="sd">     */</span>
<a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a>    <span class="k">public</span> <span class="k">function</span> <span class="nf">content</span><span class="p">()</span><span class="o">:</span> <span class="nx">Content</span>
<a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a>    <span class="p">{</span>
<a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a>        <span class="k">return</span> <span class="k">new</span> <span class="nx">Content</span><span class="p">(</span>
<a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a>            <span class="nx">view</span><span class="o">:</span> <span class="s1">&#39;mail.orders.shipped&#39;</span><span class="p">,</span>
<a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a>        <span class="p">);</span>
<a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a>    <span class="p">}</span>
<a id="__codelineno-20-31" name="__codelineno-20-31" href="#__codelineno-20-31"></a><span class="p">}</span>
</code></pre></div>
<p>データがパブリックプロパティに設定されると、ビューで自動的に利用できるようになります。したがって、Bladeテンプレート内で他のデータにアクセスするのと同じようにアクセスできます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>    Price: {{ $order-&gt;price }}
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
<p><a name="via-the-with-parameter"></a></p>
<h4 id="with"><code>with</code> パラメータ経由<a class="headerlink" href="#with" title="Permanent link">&para;</a></h4>
<p>メールのデータの形式をテンプレートに送信する前にカスタマイズしたい場合は、<code>Content</code> 定義の <code>with</code> パラメータを介してデータを手動でビューに渡すことができます。通常、データはmailableクラスのコンストラクタを介して渡されます。ただし、このデータを <code>protected</code> または <code>private</code> プロパティに設定して、データが自動的にテンプレートで利用できないようにする必要があります。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="o">&lt;?</span><span class="nx">php</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="k">namespace</span> <span class="nx">App\Mail</span><span class="p">;</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="k">use</span> <span class="nx">App\Models\Order</span><span class="p">;</span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="k">use</span> <span class="nx">Illuminate\Bus\Queueable</span><span class="p">;</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="k">use</span> <span class="nx">Illuminate\Mail\Mailable</span><span class="p">;</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="k">use</span> <span class="nx">Illuminate\Mail\Mailables\Content</span><span class="p">;</span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="k">use</span> <span class="nx">Illuminate\Queue\SerializesModels</span><span class="p">;</span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="k">class</span> <span class="nc">OrderShipped</span> <span class="k">extends</span> <span class="nx">Mailable</span>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="p">{</span>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>    <span class="k">use</span> <span class="nx">Queueable</span><span class="p">,</span> <span class="nx">SerializesModels</span><span class="p">;</span>
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a>
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a>    <span class="sd">/**</span>
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="sd">     * 新しいメッセージインスタンスを作成します。</span>
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a><span class="sd">     */</span>
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span>
<a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a>        <span class="k">protected</span> <span class="nx">Order</span> <span class="nv">$order</span><span class="p">,</span>
<a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a>    <span class="p">)</span> <span class="p">{}</span>
<a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a>
<a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a>    <span class="sd">/**</span>
<a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a><span class="sd">     * メッセージの内容定義を取得します。</span>
<a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a><span class="sd">     */</span>
<a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a>    <span class="k">public</span> <span class="k">function</span> <span class="nf">content</span><span class="p">()</span><span class="o">:</span> <span class="nx">Content</span>
<a id="__codelineno-22-26" name="__codelineno-22-26" href="#__codelineno-22-26"></a>    <span class="p">{</span>
<a id="__codelineno-22-27" name="__codelineno-22-27" href="#__codelineno-22-27"></a>        <span class="k">return</span> <span class="k">new</span> <span class="nx">Content</span><span class="p">(</span>
<a id="__codelineno-22-28" name="__codelineno-22-28" href="#__codelineno-22-28"></a>            <span class="nx">view</span><span class="o">:</span> <span class="s1">&#39;mail.orders.shipped&#39;</span><span class="p">,</span>
<a id="__codelineno-22-29" name="__codelineno-22-29" href="#__codelineno-22-29"></a>            <span class="nx">with</span><span class="o">:</span> <span class="p">[</span>
<a id="__codelineno-22-30" name="__codelineno-22-30" href="#__codelineno-22-30"></a>                <span class="s1">&#39;orderName&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">order</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">,</span>
<a id="__codelineno-22-31" name="__codelineno-22-31" href="#__codelineno-22-31"></a>                <span class="s1">&#39;orderPrice&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">order</span><span class="o">-&gt;</span><span class="na">price</span><span class="p">,</span>
<a id="__codelineno-22-32" name="__codelineno-22-32" href="#__codelineno-22-32"></a>            <span class="p">],</span>
<a id="__codelineno-22-33" name="__codelineno-22-33" href="#__codelineno-22-33"></a>        <span class="p">);</span>
<a id="__codelineno-22-34" name="__codelineno-22-34" href="#__codelineno-22-34"></a>    <span class="p">}</span>
<a id="__codelineno-22-35" name="__codelineno-22-35" href="#__codelineno-22-35"></a><span class="p">}</span>
</code></pre></div>
<p>データが <code>with</code> メソッドに渡されると、ビューで自動的に利用できるようになります。したがって、Bladeテンプレート内で他のデータにアクセスするのと同じようにアクセスできます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>    Price: {{ $orderPrice }}
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
<p><a name="attachments"></a></p>
<h3 id="_12">添付ファイル<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<p>メールに添付ファイルを追加するには、メッセージの <code>attachments</code> メソッドによって返される配列に添付ファイルを追加します。まず、<code>Attachment</code> クラスによって提供される <code>fromPath</code> メソッドにファイルパスを指定することで、添付ファイルを追加できます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="k">use</span> <span class="nx">Illuminate\Mail\Mailables\Attachment</span><span class="p">;</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="sd">/**</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="sd"> * メッセージの添付ファイルを取得します。</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="sd"> *</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="sd"> * @return array&lt;int, \Illuminate\Mail\Mailables\Attachment&gt;</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="sd"> */</span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="k">public</span> <span class="k">function</span> <span class="nf">attachments</span><span class="p">()</span><span class="o">:</span> <span class="k">array</span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="p">{</span>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>    <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>        <span class="nx">Attachment</span><span class="o">::</span><span class="na">fromPath</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">),</span>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>    <span class="p">];</span>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="p">}</span>
</code></pre></div>
<p>メッセージにファイルを添付する際、<code>as</code> メソッドと <code>withMime</code> メソッドを使用して、添付ファイルの表示名やMIMEタイプを指定することもできます。</p>
<div class="highlight"><pre><span></span><code><span class="sd">/**</span>
<span class="sd"> * メッセージの添付ファイルを取得する。</span>
<span class="sd"> *</span>
<span class="sd"> * @return array&lt;int, \Illuminate\Mail\Mailables\Attachment&gt;</span>
<span class="sd"> */</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">attachments</span><span class="p">()</span><span class="o">:</span> <span class="k">array</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="nx">Attachment</span><span class="o">::</span><span class="na">fromPath</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">as</span><span class="p">(</span><span class="s1">&#39;name.pdf&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">withMime</span><span class="p">(</span><span class="s1">&#39;application/pdf&#39;</span><span class="p">),</span>
    <span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p><a name="attaching-files-from-disk"></a></p>
<h4 id="_13">ディスクからのファイル添付<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<p>ファイルを<a href="filesystem.html">ファイルシステムディスク</a>のいずれかに保存している場合、<code>fromStorage</code> 添付メソッドを使用してメールに添付することができます。</p>
<div class="highlight"><pre><span></span><code><span class="sd">/**</span>
<span class="sd"> * メッセージの添付ファイルを取得する。</span>
<span class="sd"> *</span>
<span class="sd"> * @return array&lt;int, \Illuminate\Mail\Mailables\Attachment&gt;</span>
<span class="sd"> */</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">attachments</span><span class="p">()</span><span class="o">:</span> <span class="k">array</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="nx">Attachment</span><span class="o">::</span><span class="na">fromStorage</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">),</span>
    <span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p>もちろん、添付ファイルの名前とMIMEタイプを指定することもできます。</p>
<div class="highlight"><pre><span></span><code><span class="sd">/**</span>
<span class="sd"> * メッセージの添付ファイルを取得する。</span>
<span class="sd"> *</span>
<span class="sd"> * @return array&lt;int, \Illuminate\Mail\Mailables\Attachment&gt;</span>
<span class="sd"> */</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">attachments</span><span class="p">()</span><span class="o">:</span> <span class="k">array</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="nx">Attachment</span><span class="o">::</span><span class="na">fromStorage</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">as</span><span class="p">(</span><span class="s1">&#39;name.pdf&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">withMime</span><span class="p">(</span><span class="s1">&#39;application/pdf&#39;</span><span class="p">),</span>
    <span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p>デフォルトのディスク以外のストレージディスクを指定する必要がある場合は、<code>fromStorageDisk</code> メソッドを使用できます。</p>
<div class="highlight"><pre><span></span><code><span class="sd">/**</span>
<span class="sd"> * メッセージの添付ファイルを取得する。</span>
<span class="sd"> *</span>
<span class="sd"> * @return array&lt;int, \Illuminate\Mail\Mailables\Attachment&gt;</span>
<span class="sd"> */</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">attachments</span><span class="p">()</span><span class="o">:</span> <span class="k">array</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="nx">Attachment</span><span class="o">::</span><span class="na">fromStorageDisk</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/file&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">as</span><span class="p">(</span><span class="s1">&#39;name.pdf&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">withMime</span><span class="p">(</span><span class="s1">&#39;application/pdf&#39;</span><span class="p">),</span>
    <span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p><a name="raw-data-attachments"></a></p>
<h4 id="_14">生データの添付<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<p><code>fromData</code> 添付メソッドを使用して、生のバイト文字列を添付ファイルとして添付することができます。例えば、メモリ内でPDFを生成し、ディスクに書き込まずにメールに添付したい場合にこのメソッドを使用できます。<code>fromData</code> メソッドは、添付ファイルに割り当てるべき名前と共に、生データバイトを解決するクロージャを受け取ります。</p>
<div class="highlight"><pre><span></span><code><span class="sd">/**</span>
<span class="sd"> * メッセージの添付ファイルを取得する。</span>
<span class="sd"> *</span>
<span class="sd"> * @return array&lt;int, \Illuminate\Mail\Mailables\Attachment&gt;</span>
<span class="sd"> */</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">attachments</span><span class="p">()</span><span class="o">:</span> <span class="k">array</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="nx">Attachment</span><span class="o">::</span><span class="na">fromData</span><span class="p">(</span><span class="nx">fn</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pdf</span><span class="p">,</span> <span class="s1">&#39;Report.pdf&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">withMime</span><span class="p">(</span><span class="s1">&#39;application/pdf&#39;</span><span class="p">),</span>
    <span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p><a name="inline-attachments"></a></p>
<h3 id="_15">インライン添付<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<p>メールにインライン画像を埋め込むことは通常、面倒ですが、Laravelはメールに画像を添付する便利な方法を提供しています。インライン画像を埋め込むには、メールテンプレート内で <code>$message</code> 変数の <code>embed</code> メソッドを使用します。Laravelは自動的に <code>$message</code> 変数をすべてのメールテンプレートで利用できるようにしているため、手動で渡す必要はありません。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="x">&lt;body&gt;</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="x">    ここに画像があります:</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="x">    &lt;img src=&quot;{{ $message-&gt;embed($pathToImage) }}&quot;&gt;</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="x">&lt;/body&gt;</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code>$message</code> 変数はプレーンテキストメッセージテンプレートでは利用できません。プレーンテキストメッセージはインライン添付を使用しないためです。</p>
</div>
<p><a name="embedding-raw-data-attachments"></a></p>
<h4 id="_16">生データ添付の埋め込み<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h4>
<p>すでに生の画像データ文字列を持っており、それをメールテンプレートに埋め込みたい場合は、<code>$message</code> 変数の <code>embedData</code> メソッドを呼び出すことができます。<code>embedData</code> メソッドを呼び出す際には、埋め込み画像に割り当てるべきファイル名を指定する必要があります。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="x">&lt;body&gt;</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="x">    ここに生データからの画像があります:</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="x">    &lt;img src=&quot;{{ $message-&gt;embedData($data, &#39;example-image.jpg&#39;) }}&quot;&gt;</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="x">&lt;/body&gt;</span>
</code></pre></div>
<p><a name="attachable-objects"></a></p>
<h3 id="_17">添付可能なオブジェクト<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p>ファイルを添付する際に単純な文字列パスを使用することはしばしば十分ですが、多くの場合、アプリケーション内の添付可能なエンティティはクラスによって表現されます。例えば、アプリケーションがメッセージに写真を添付する場合、アプリケーションにはその写真を表す <code>Photo</code> モデルがあるかもしれません。その場合、<code>Photo</code> モデルを <code>attach</code> メソッドに渡すだけで便利ではないでしょうか？添付可能なオブジェクトを使用すると、それが可能になります。</p>
<p>まず、メッセージに添付可能なオブジェクトに <code>Illuminate\Contracts\Mail\Attachable</code> インターフェースを実装します。このインターフェースは、クラスが <code>Illuminate\Mail\Attachment</code> インスタンスを返す <code>toMailAttachment</code> メソッドを定義することを要求します。</p>
<div class="highlight"><pre><span></span><code><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">App\Models</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Illuminate\Contracts\Mail\Attachable</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Model</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Mail\Attachment</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Photo</span> <span class="k">extends</span> <span class="nx">Model</span> <span class="k">implements</span> <span class="nx">Attachable</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * モデルの添付可能な表現を取得する。</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">toMailAttachment</span><span class="p">()</span><span class="o">:</span> <span class="nx">Attachment</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nx">Attachment</span><span class="o">::</span><span class="na">fromPath</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>添付可能なオブジェクトを定義したら、メールメッセージを構築する際に <code>attachments</code> メソッドからそのオブジェクトのインスタンスを返すことができます。</p>
<div class="highlight"><pre><span></span><code><span class="sd">/**</span>
<span class="sd"> * メッセージの添付ファイルを取得する。</span>
<span class="sd"> *</span>
<span class="sd"> * @return array&lt;int, \Illuminate\Mail\Mailables\Attachment&gt;</span>
<span class="sd"> */</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">attachments</span><span class="p">()</span><span class="o">:</span> <span class="k">array</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">photo</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p>もちろん、添付データはAmazon S3などのリモートファイルストレージサービスに保存されている場合があります。そのため、Laravelはアプリケーションの<a href="filesystem.html">ファイルシステムディスク</a>に保存されているデータから添付ファイルインスタンスを生成することも可能です。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// デフォルトディスク上のファイルから添付ファイルを作成する...</span>
<span class="k">return</span> <span class="nx">Attachment</span><span class="o">::</span><span class="na">fromStorage</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">path</span><span class="p">);</span>

<span class="c1">// 特定のディスク上のファイルから添付ファイルを作成する...</span>
<span class="k">return</span> <span class="nx">Attachment</span><span class="o">::</span><span class="na">fromStorageDisk</span><span class="p">(</span><span class="s1">&#39;backblaze&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">path</span><span class="p">);</span>
</code></pre></div>
<p>さらに、メモリ内にあるデータを介して添付ファイルインスタンスを作成することもできます。これを行うには、<code>fromData</code> メソッドにクロージャを提供します。クロージャは添付ファイルを表す生データを返す必要があります。</p>
<div class="highlight"><pre><span></span><code><span class="k">return</span> <span class="nx">Attachment</span><span class="o">::</span><span class="na">fromData</span><span class="p">(</span><span class="nx">fn</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">content</span><span class="p">,</span> <span class="s1">&#39;Photo Name&#39;</span><span class="p">);</span>
</code></pre></div>
<p>Laravelはまた、添付ファイルをカスタマイズするために使用できる追加のメソッドを提供しています。例えば、<code>as</code> メソッドと <code>withMime</code> メソッドを使用して、ファイルの名前とMIMEタイプをカスタマイズできます。</p>
<div class="highlight"><pre><span></span><code><span class="k">return</span> <span class="nx">Attachment</span><span class="o">::</span><span class="na">fromPath</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">as</span><span class="p">(</span><span class="s1">&#39;Photo Name&#39;</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">withMime</span><span class="p">(</span><span class="s1">&#39;image/jpeg&#39;</span><span class="p">);</span>
</code></pre></div>
<p><a name="headers"></a></p>
<h3 id="_18">ヘッダー<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p>送信メッセージに追加のヘッダーを添付する必要がある場合があります。例えば、カスタムの <code>Message-Id</code> やその他の任意のテキストヘッダーを設定する必要がある場合です。</p>
<p>これを実現するには、mailableに <code>headers</code> メソッドを定義します。<code>headers</code> メソッドは <code>Illuminate\Mail\Mailables\Headers</code> インスタンスを返す必要があります。このクラスは <code>messageId</code>、<code>references</code>、<code>text</code> パラメータを受け取ります。もちろん、特定のメッセージに必要なパラメータのみを提供することができます。</p>
<div class="highlight"><pre><span></span><code><span class="k">use</span> <span class="nx">Illuminate\Mail\Mailables\Headers</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * メッセージのヘッダーを取得する。</span>
<span class="sd"> */</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">headers</span><span class="p">()</span><span class="o">:</span> <span class="nx">Headers</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Headers</span><span class="p">(</span>
        <span class="nx">messageId</span><span class="o">:</span> <span class="s1">&#39;custom-message-id@example.com&#39;</span><span class="p">,</span>
        <span class="nx">references</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;previous-message@example.com&#39;</span><span class="p">],</span>
        <span class="nx">text</span><span class="o">:</span> <span class="p">[</span>
            <span class="s1">&#39;X-Custom-Header&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Custom Value&#39;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p><a name="tags-and-metadata"></a></p>
<h3 id="_19">タグとメタデータ<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<p>MailgunやPostmarkなどの一部のサードパーティメールプロバイダは、メッセージの「タグ」と「メタデータ」をサポートしており、アプリケーションから送信されたメールをグループ化して追跡するために使用できます。<code>Envelope</code> 定義を介してメールメッセージにタグとメタデータを追加できます。</p>
<div class="highlight"><pre><span></span><code><span class="k">use</span> <span class="nx">Illuminate\Mail\Mailables\Envelope</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * メッセージのエンベロープを取得する。</span>
<span class="sd"> *</span>
<span class="sd"> * @return \Illuminate\Mail\Mailables\Envelope</span>
<span class="sd"> */</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">envelope</span><span class="p">()</span><span class="o">:</span> <span class="nx">Envelope</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Envelope</span><span class="p">(</span>
        <span class="nx">subject</span><span class="o">:</span> <span class="s1">&#39;Order Shipped&#39;</span><span class="p">,</span>
        <span class="nx">tags</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;shipment&#39;</span><span class="p">],</span>
        <span class="nx">metadata</span><span class="o">:</span> <span class="p">[</span>
            <span class="s1">&#39;order_id&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">order</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>アプリケーションがMailgunドライバを使用している場合は、Mailgunのドキュメントを参照して、<a href="https://documentation.mailgun.com/en/latest/user_manual.html#tagging-1">タグ</a>と<a href="https://documentation.mailgun.com/en/latest/user_manual.html#attaching-data-to-messages">メタデータ</a>に関する詳細情報を確認できます。同様に、Postmarkのドキュメントも、<a href="https://postmarkapp.com/blog/tags-support-for-smtp">タグ</a>と<a href="https://postmarkapp.com/support/article/1125-custom-metadata-faq">メタデータ</a>のサポートに関する詳細情報を確認できます。</p>
<p>アプリケーションがAmazon SESを使用してメールを送信している場合は、<code>metadata</code> メソッドを使用してメッセージに<a href="https://docs.aws.amazon.com/ses/latest/APIReference/API_MessageTag.html">SES「タグ」</a>を添付する必要があります。</p>
<p><a name="customizing-the-symfony-message"></a></p>
<h3 id="symfony">Symfonyメッセージのカスタマイズ<a class="headerlink" href="#symfony" title="Permanent link">&para;</a></h3>
<p>Laravelのメール機能はSymfony Mailerによって提供されています。Laravelでは、メッセージを送信する前にSymfonyメッセージインスタンスで呼び出されるカスタムコールバックを登録できます。これにより、メッセージを送信する前に深くカスタマイズする機会が得られます。これを実現するには、<code>Envelope</code> 定義に <code>using</code> パラメータを定義します。</p>
<div class="highlight"><pre><span></span><code><span class="k">use</span> <span class="nx">Illuminate\Mail\Mailables\Envelope</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\Mime\Email</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * メッセージのエンベロープを取得する。</span>
<span class="sd"> */</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">envelope</span><span class="p">()</span><span class="o">:</span> <span class="nx">Envelope</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Envelope</span><span class="p">(</span>
        <span class="nx">subject</span><span class="o">:</span> <span class="s1">&#39;Order Shipped&#39;</span><span class="p">,</span>
        <span class="nx">using</span><span class="o">:</span> <span class="p">[</span>
            <span class="k">function</span> <span class="p">(</span><span class="nx">Email</span> <span class="nv">$message</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// ...</span>
            <span class="p">},</span>
        <span class="p">]</span>
    <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p><a name="markdown-mailables"></a></p>
<h2 id="markdown">Markdownメール<a class="headerlink" href="#markdown" title="Permanent link">&para;</a></h2>
<p>Markdownメールは、定義済みのテンプレートとメール通知のコンポーネントを利用できるため、メールメッセージを簡単に作成できます。Markdownを使用してメッセージを記述すると、Laravelは美しくレスポンシブなHTMLテンプレートをレンダリングし、同時にプレーンテキストバージョンを自動的に生成します。</p>
<p>Markdown形式のメールメッセージを使用すると、<a href="notifications.html#mail-notifications">メール通知</a>の事前に構築されたテンプレートとコンポーネントをメールで利用できます。メッセージはMarkdownで記述されているため、Laravelはメッセージのために美しくレスポンシブなHTMLテンプレートをレンダリングするだけでなく、プレーンテキストの対応版も自動的に生成します。</p>
<p><a name="generating-markdown-mailables"></a></p>
<h3 id="markdown-mailables">Markdown Mailablesの生成<a class="headerlink" href="#markdown-mailables" title="Permanent link">&para;</a></h3>
<p>Markdownテンプレートに対応するmailableを生成するには、<code>make:mail</code> Artisanコマンドの<code>--markdown</code>オプションを使用できます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>php<span class="w"> </span>artisan<span class="w"> </span>make:mail<span class="w"> </span>OrderShipped<span class="w"> </span>--markdown<span class="o">=</span>mail.orders.shipped
</code></pre></div>
<p>次に、mailableの<code>content</code>メソッド内で<code>content</code>定義を設定する際に、<code>view</code>パラメータの代わりに<code>markdown</code>パラメータを使用します。</p>
<div class="highlight"><pre><span></span><code><span class="k">use</span> <span class="nx">Illuminate\Mail\Mailables\Content</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * メッセージのコンテンツ定義を取得する。</span>
<span class="sd"> */</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">content</span><span class="p">()</span><span class="o">:</span> <span class="nx">Content</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Content</span><span class="p">(</span>
        <span class="nx">markdown</span><span class="o">:</span> <span class="s1">&#39;mail.orders.shipped&#39;</span><span class="p">,</span>
        <span class="nx">with</span><span class="o">:</span> <span class="p">[</span>
            <span class="s1">&#39;url&#39;</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">orderUrl</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p><a name="writing-markdown-messages"></a></p>
<h3 id="markdown_1">Markdownメッセージの記述<a class="headerlink" href="#markdown_1" title="Permanent link">&para;</a></h3>
<p>Markdown形式のメールは、BladeコンポーネントとMarkdown構文を組み合わせて使用し、Laravelの事前に構築されたメールUIコンポーネントを活用しながら、メールメッセージを簡単に構築できます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="x">&lt;x-mail::message&gt;</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="x"># 注文出荷</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="x">あなたの注文が出荷されました！</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="x">&lt;x-mail::button :url=&quot;$url&quot;&gt;</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="x">注文を見る</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="x">&lt;/x-mail::button&gt;</span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="x">ありがとうございます,&lt;br&gt;</span>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="x">{{ config(&#39;app.name&#39;) }}</span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="x">&lt;/x-mail::message&gt;</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Markdownメールを記述する際には、過剰なインデントを使用しないでください。Markdown標準に従い、Markdownパーサーはインデントされたコンテンツをコードブロックとしてレンダリングします。</p>
</div>
<p><a name="button-component"></a></p>
<h4 id="_20">ボタンコンポーネント<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h4>
<p>ボタンコンポーネントは、中央揃えのボタンリンクをレンダリングします。このコンポーネントは、<code>url</code>とオプションの<code>color</code>の2つの引数を受け取ります。サポートされている色は<code>primary</code>、<code>success</code>、<code>error</code>です。メッセージには必要なだけボタンコンポーネントを追加できます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="x">&lt;x-mail::button :url=&quot;$url&quot; color=&quot;success&quot;&gt;</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="x">注文を見る</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="x">&lt;/x-mail::button&gt;</span>
</code></pre></div>
<p><a name="panel-component"></a></p>
<h4 id="_21">パネルコンポーネント<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h4>
<p>パネルコンポーネントは、メッセージの残りの部分とは少し異なる背景色を持つパネル内に指定されたテキストブロックをレンダリングします。これにより、特定のテキストブロックに注意を引くことができます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="x">&lt;x-mail::panel&gt;</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="x">これはパネルの内容です。</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="x">&lt;/x-mail::panel&gt;</span>
</code></pre></div>
<p><a name="table-component"></a></p>
<h4 id="_22">テーブルコンポーネント<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h4>
<p>テーブルコンポーネントを使用すると、MarkdownテーブルをHTMLテーブルに変換できます。このコンポーネントは、Markdownテーブルをコンテンツとして受け取ります。テーブルの列の配置は、デフォルトのMarkdownテーブル配置構文を使用してサポートされています。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="x">&lt;x-mail::table&gt;</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="x">| Laravel       | テーブル         | 例             |</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="x">| ------------- | :-----------: | ------------: |</span>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="x">| 列2は         | 中央揃え        | $10           |</span>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="x">| 列3は         | 右揃え          | $20           |</span>
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="x">&lt;/x-mail::table&gt;</span>
</code></pre></div>
<p><a name="customizing-the-components"></a></p>
<h3 id="_23">コンポーネントのカスタマイズ<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h3>
<p>Markdownメールコンポーネントをすべて自分のアプリケーションにエクスポートしてカスタマイズすることができます。コンポーネントをエクスポートするには、<code>vendor:publish</code> Artisanコマンドを使用して<code>laravel-mail</code>アセットタグを公開します。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>php<span class="w"> </span>artisan<span class="w"> </span>vendor:publish<span class="w"> </span>--tag<span class="o">=</span>laravel-mail
</code></pre></div>
<p>このコマンドは、Markdownメールコンポーネントを<code>resources/views/vendor/mail</code>ディレクトリに公開します。<code>mail</code>ディレクトリには、<code>html</code>と<code>text</code>のディレクトリが含まれ、それぞれに利用可能なすべてのコンポーネントの表現が含まれています。これらのコンポーネントは自由にカスタマイズできます。</p>
<p><a name="customizing-the-css"></a></p>
<h4 id="css">CSSのカスタマイズ<a class="headerlink" href="#css" title="Permanent link">&para;</a></h4>
<p>コンポーネントをエクスポートした後、<code>resources/views/vendor/mail/html/themes</code>ディレクトリに<code>default.css</code>ファイルが含まれます。このファイルのCSSをカスタマイズすると、MarkdownメールメッセージのHTML表現内のインラインCSSスタイルに自動的に変換されます。</p>
<p>LaravelのMarkdownコンポーネント用にまったく新しいテーマを構築したい場合は、<code>html/themes</code>ディレクトリ内にCSSファイルを配置できます。CSSファイルに名前を付けて保存した後、アプリケーションの<code>config/mail.php</code>設定ファイルの<code>theme</code>オプションを新しいテーマの名前と一致するように更新します。</p>
<p>個々のmailableのテーマをカスタマイズするには、そのmailableクラスの<code>$theme</code>プロパティを、そのmailableを送信する際に使用するテーマの名前に設定できます。</p>
<p><a name="sending-mail"></a></p>
<h2 id="_24">メールの送信<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h2>
<p>メッセージを送信するには、<code>Mail</code> <a href="facades.html">ファサード</a>の<code>to</code>メソッドを使用します。<code>to</code>メソッドは、メールアドレス、ユーザーインスタンス、またはユーザーのコレクションを受け取ります。オブジェクトまたはオブジェクトのコレクションを渡すと、メーラーはメールの受信者を決定する際に自動的にそれらの<code>email</code>および<code>name</code>プロパティを使用するため、これらの属性がオブジェクトで利用可能であることを確認してください。受信者を指定したら、mailableクラスのインスタンスを<code>send</code>メソッドに渡すことができます。</p>
<div class="highlight"><pre><span></span><code><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">App\Http\Controllers</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">App\Http\Controllers\Controller</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Mail\OrderShipped</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Models\Order</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Http\RedirectResponse</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Http\Request</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Support\Facades\Mail</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">OrderShipmentController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * 指定された注文を出荷する。</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">store</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span><span class="o">:</span> <span class="nx">RedirectResponse</span>
    <span class="p">{</span>
        <span class="nv">$order</span> <span class="o">=</span> <span class="nx">Order</span><span class="o">::</span><span class="na">findOrFail</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">order_id</span><span class="p">);</span>

        <span class="c1">// 注文を出荷する...</span>

        <span class="nx">Mail</span><span class="o">::</span><span class="na">to</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">())</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="k">new</span> <span class="nx">OrderShipped</span><span class="p">(</span><span class="nv">$order</span><span class="p">));</span>

        <span class="k">return</span> <span class="nx">redirect</span><span class="p">(</span><span class="s1">&#39;/orders&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>メッセージを送信する際に、"to"受信者のみを指定することに限定されません。"to"、"cc"、"bcc"受信者を自由に設定するために、それぞれのメソッドをチェーンできます。</p>
<div class="highlight"><pre><span></span><code><span class="nx">Mail</span><span class="o">::</span><span class="na">to</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">())</span>
    <span class="o">-&gt;</span><span class="na">cc</span><span class="p">(</span><span class="nv">$moreUsers</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">bcc</span><span class="p">(</span><span class="nv">$evenMoreUsers</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="k">new</span> <span class="nx">OrderShipped</span><span class="p">(</span><span class="nv">$order</span><span class="p">));</span>
</code></pre></div>
<p><a name="looping-over-recipients"></a></p>
<h4 id="_25">受信者をループで処理する<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h4>
<p>場合によっては、受信者/メールアドレスのリストを反復処理してmailableを送信する必要があります。しかし、<code>to</code>メソッドはmailableの受信者リストにメールアドレスを追加するため、ループの各反復で以前のすべての受信者に別のメールが送信されます。したがって、各受信者に対して常に新しいmailableインスタンスを再作成する必要があります。</p>
<div class="highlight"><pre><span></span><code><span class="k">foreach</span> <span class="p">([</span><span class="s1">&#39;taylor@example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;dries@example.com&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$recipient</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Mail</span><span class="o">::</span><span class="na">to</span><span class="p">(</span><span class="nv">$recipient</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="k">new</span> <span class="nx">OrderShipped</span><span class="p">(</span><span class="nv">$order</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>
<p><a name="sending-mail-via-a-specific-mailer"></a></p>
<h4 id="_26">特定のメーラー経由でメールを送信する<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h4>
<p>デフォルトでは、Laravelはアプリケーションの<code>mail</code>設定ファイルで<code>default</code>として設定されたメーラーを使用してメールを送信します。しかし、<code>mailer</code>メソッドを使用して、特定のメーラー設定を使用してメッセージを送信できます。</p>
<div class="highlight"><pre><span></span><code><span class="nx">Mail</span><span class="o">::</span><span class="na">mailer</span><span class="p">(</span><span class="s1">&#39;postmark&#39;</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">to</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">())</span>
        <span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="k">new</span> <span class="nx">OrderShipped</span><span class="p">(</span><span class="nv">$order</span><span class="p">));</span>
</code></pre></div>
<p><a name="queueing-mail"></a></p>
<h3 id="_27">メールのキューイング<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h3>
<p><a name="queueing-a-mail-message"></a></p>
<h4 id="_28">メールメッセージのキューイング<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h4>
<p>メールメッセージの送信はアプリケーションのレスポンス時間に悪影響を与える可能性があるため、多くの開発者はメールメッセージをバックグラウンドで送信するためにキューイングします。Laravelは、組み込みの<a href="queues.html">統一キューAPI</a>を使用してこれを簡単にします。メッセージの受信者を指定した後、<code>Mail</code>ファサードの<code>queue</code>メソッドを使用してメッセージをキューに入れることができます。</p>
<div class="highlight"><pre><span></span><code><span class="nx">Mail</span><span class="o">::</span><span class="na">to</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">())</span>
    <span class="o">-&gt;</span><span class="na">cc</span><span class="p">(</span><span class="nv">$moreUsers</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">bcc</span><span class="p">(</span><span class="nv">$evenMoreUsers</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">queue</span><span class="p">(</span><span class="k">new</span> <span class="nx">OrderShipped</span><span class="p">(</span><span class="nv">$order</span><span class="p">));</span>
</code></pre></div>
<p>このメソッドは、メッセージがバックグラウンドで送信されるように、ジョブをキューに自動的にプッシュします。この機能を使用する前に、<a href="queues.html">キューを設定</a>する必要があります。</p>
<p><a name="delayed-message-queueing"></a></p>
<h4 id="_29">遅延メッセージキューイング<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h4>
<p>キューに入れられたメールメッセージの配信を遅延させたい場合は、<code>later</code>メソッドを使用できます。<code>later</code>メソッドの最初の引数は、メッセージを送信する時期を示す<code>DateTime</code>インスタンスを受け取ります。</p>
<div class="highlight"><pre><span></span><code><span class="nx">Mail</span><span class="o">::</span><span class="na">to</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">())</span>
    <span class="o">-&gt;</span><span class="na">cc</span><span class="p">(</span><span class="nv">$moreUsers</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">bcc</span><span class="p">(</span><span class="nv">$evenMoreUsers</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">later</span><span class="p">(</span><span class="nx">now</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">addMinutes</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="k">new</span> <span class="nx">OrderShipped</span><span class="p">(</span><span class="nv">$order</span><span class="p">));</span>
</code></pre></div>
<p><a name="pushing-to-specific-queues"></a></p>
<h4 id="_30">特定のキューにプッシュする<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h4>
<p><code>make:mail</code>コマンドを使用して生成されたすべてのmailableクラスは、<code>Illuminate\Bus\Queueable</code>トレイトを使用しているため、任意のmailableクラスインスタンスで<code>onQueue</code>および<code>onConnection</code>メソッドを呼び出して、メッセージの接続とキュー名を指定できます。</p>
<div class="highlight"><pre><span></span><code><span class="nv">$message</span> <span class="o">=</span> <span class="p">(</span><span class="k">new</span> <span class="nx">OrderShipped</span><span class="p">(</span><span class="nv">$order</span><span class="p">))</span>
                <span class="o">-&gt;</span><span class="na">onConnection</span><span class="p">(</span><span class="s1">&#39;sqs&#39;</span><span class="p">)</span>
                <span class="o">-&gt;</span><span class="na">onQueue</span><span class="p">(</span><span class="s1">&#39;emails&#39;</span><span class="p">);</span>

<span class="nx">Mail</span><span class="o">::</span><span class="na">to</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">())</span>
    <span class="o">-&gt;</span><span class="na">cc</span><span class="p">(</span><span class="nv">$moreUsers</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">bcc</span><span class="p">(</span><span class="nv">$evenMoreUsers</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">queue</span><span class="p">(</span><span class="nv">$message</span><span class="p">);</span>
</code></pre></div>
<p><a name="queueing-by-default"></a></p>
<h4 id="_31">デフォルトでキューイングする<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h4>
<p>常にキューに入れたいmailableクラスがある場合は、クラスに<code>ShouldQueue</code>コントラクトを実装できます。これで、メールを送信する際に<code>send</code>メソッドを呼び出しても、mailableはキューに入れられます。</p>
<div class="highlight"><pre><span></span><code><span class="k">use</span> <span class="nx">Illuminate\Contracts\Queue\ShouldQueue</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">OrderShipped</span> <span class="k">extends</span> <span class="nx">Mailable</span> <span class="k">implements</span> <span class="nx">ShouldQueue</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<p><a name="queued-mailables-and-database-transactions"></a></p>
<h4 id="mailables">キューに入れられたMailablesとデータベーストランザクション<a class="headerlink" href="#mailables" title="Permanent link">&para;</a></h4>
<p>データベーストランザクション内でキューに入れられたメールがディスパッチされると、データベーストランザクションがコミットされる前にキューによって処理される可能性があります。この場合、データベーストランザクション中にモデルやデータベースレコードに加えた更新がまだデータベースに反映されていない可能性があります。また、トランザクション内で作成されたモデルやデータベースレコードがデータベースに存在しない可能性もあります。メールがこれらのモデルに依存している場合、キューに入れられたメールを送信するジョブが処理される際に予期しないエラーが発生する可能性があります。</p>
<p>キュー接続の <code>after_commit</code> 設定オプションが <code>false</code> に設定されている場合でも、メールメッセージを送信する際に <code>afterCommit</code> メソッドを呼び出すことで、すべての開いているデータベーストランザクションがコミットされた後に特定のキューに入れられたメールをディスパッチするように指示できます。</p>
<div class="highlight"><pre><span></span><code><span class="nx">Mail</span><span class="o">::</span><span class="na">to</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">())</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span>
    <span class="p">(</span><span class="k">new</span> <span class="nx">OrderShipped</span><span class="p">(</span><span class="nv">$order</span><span class="p">))</span><span class="o">-&gt;</span><span class="na">afterCommit</span><span class="p">()</span>
<span class="p">);</span>
</code></pre></div>
<p>または、メールのコンストラクタから <code>afterCommit</code> メソッドを呼び出すこともできます。</p>
<div class="highlight"><pre><span></span><code><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">App\Mail</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Illuminate\Bus\Queueable</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Contracts\Queue\ShouldQueue</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Mail\Mailable</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Queue\SerializesModels</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">OrderShipped</span> <span class="k">extends</span> <span class="nx">Mailable</span> <span class="k">implements</span> <span class="nx">ShouldQueue</span>
<span class="p">{</span>
    <span class="k">use</span> <span class="nx">Queueable</span><span class="p">,</span> <span class="nx">SerializesModels</span><span class="p">;</span>

    <span class="sd">/**</span>
<span class="sd">     * 新しいメッセージインスタンスを作成する。</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">afterCommit</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>これらの問題を回避する方法について詳しく知りたい場合は、<a href="queues.html#jobs-and-database-transactions">キューされたジョブとデータベーストランザクション</a>に関するドキュメントを確認してください。</p>
</div>
<p><a name="rendering-mailables"></a></p>
<h2 id="_32">メールのレンダリング<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h2>
<p>メールを送信せずにメールのHTMLコンテンツをキャプチャしたい場合があります。これを実現するには、メールの <code>render</code> メソッドを呼び出します。このメソッドは、メールの評価済みHTMLコンテンツを文字列として返します。</p>
<div class="highlight"><pre><span></span><code><span class="k">use</span> <span class="nx">App\Mail\InvoicePaid</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Models\Invoice</span><span class="p">;</span>

<span class="nv">$invoice</span> <span class="o">=</span> <span class="nx">Invoice</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

<span class="k">return</span> <span class="p">(</span><span class="k">new</span> <span class="nx">InvoicePaid</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">))</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">();</span>
</code></pre></div>
<p><a name="previewing-mailables-in-the-browser"></a></p>
<h3 id="_33">ブラウザでのメールのプレビュー<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h3>
<p>メールのテンプレートを設計する際、通常のBladeテンプレートのようにブラウザでレンダリングされたメールをすばやくプレビューすると便利です。このため、Laravelでは、ルートクロージャまたはコントローラから直接メールを返すことができます。メールが返されると、ブラウザにレンダリングされて表示され、実際のメールアドレスに送信する必要なくデザインをすばやくプレビューできます。</p>
<div class="highlight"><pre><span></span><code><span class="nx">Route</span><span class="o">::</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;/mailable&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nv">$invoice</span> <span class="o">=</span> <span class="nx">App\Models\Invoice</span><span class="o">::</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

    <span class="k">return</span> <span class="k">new</span> <span class="nx">App\Mail\InvoicePaid</span><span class="p">(</span><span class="nv">$invoice</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>
<p><a name="localizing-mailables"></a></p>
<h2 id="_34">メールのローカライズ<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h2>
<p>Laravelでは、リクエストの現在のロケール以外のロケールでメールを送信できます。メールがキューに入れられている場合でも、このロケールを記憶します。</p>
<p>これを実現するために、<code>Mail</code> ファサードは、希望する言語を設定するための <code>locale</code> メソッドを提供します。メールのテンプレートが評価されると、アプリケーションはこのロケールに変更され、評価が完了すると前のロケールに戻ります。</p>
<div class="highlight"><pre><span></span><code><span class="nx">Mail</span><span class="o">::</span><span class="na">to</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">())</span><span class="o">-&gt;</span><span class="na">locale</span><span class="p">(</span><span class="s1">&#39;es&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span>
    <span class="k">new</span> <span class="nx">OrderShipped</span><span class="p">(</span><span class="nv">$order</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>
<p><a name="user-preferred-locales"></a></p>
<h3 id="_35">ユーザーの優先ロケール<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h3>
<p>アプリケーションは、各ユーザーの優先ロケールを保存する場合があります。1つ以上のモデルに <code>HasLocalePreference</code> コントラクトを実装することで、Laravelにメール送信時にこの保存されたロケールを使用するよう指示できます。</p>
<div class="highlight"><pre><span></span><code><span class="k">use</span> <span class="nx">Illuminate\Contracts\Translation\HasLocalePreference</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">Model</span> <span class="k">implements</span> <span class="nx">HasLocalePreference</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * ユーザーの優先ロケールを取得する。</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">preferredLocale</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">locale</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>このインターフェースを実装すると、Laravelはメールと通知をモデルに送信する際に自動的に優先ロケールを使用します。したがって、このインターフェースを使用する場合、<code>locale</code> メソッドを呼び出す必要はありません。</p>
<div class="highlight"><pre><span></span><code><span class="nx">Mail</span><span class="o">::</span><span class="na">to</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">())</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">(</span><span class="k">new</span> <span class="nx">OrderShipped</span><span class="p">(</span><span class="nv">$order</span><span class="p">));</span>
</code></pre></div>
<p><a name="testing-mailables"></a></p>
<h2 id="_36">テスト<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h2>
<p><a name="testing-mailable-content"></a></p>
<h3 id="_37">メールの内容のテスト<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h3>
<p>Laravelは、メールの構造を検査するためのさまざまなメソッドを提供します。さらに、Laravelは、メールに期待するコンテンツが含まれていることをテストするための便利なメソッドを提供します。これらのメソッドは、<code>assertSeeInHtml</code>、<code>assertDontSeeInHtml</code>、<code>assertSeeInOrderInHtml</code>、<code>assertSeeInText</code>、<code>assertDontSeeInText</code>、<code>assertSeeInOrderInText</code>、<code>assertHasAttachment</code>、<code>assertHasAttachedData</code>、<code>assertHasAttachmentFromStorage</code>、および <code>assertHasAttachmentFromStorageDisk</code> です。</p>
<p>予想されるように、「HTML」アサーションは、メールのHTMLバージョンに特定の文字列が含まれていることをアサートし、「テキスト」アサーションは、メールのプレーンテキストバージョンに特定の文字列が含まれていることをアサートします。</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Pest</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="k">use</span> <span class="nx">App\Mail\InvoicePaid</span><span class="p">;</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="k">use</span> <span class="nx">App\Models\User</span><span class="p">;</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;mailable content&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>    <span class="nv">$user</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">factory</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">();</span>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>    <span class="nv">$mailable</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">InvoicePaid</span><span class="p">(</span><span class="nv">$user</span><span class="p">);</span>
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertFrom</span><span class="p">(</span><span class="s1">&#39;jeffrey@example.com&#39;</span><span class="p">);</span>
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertTo</span><span class="p">(</span><span class="s1">&#39;taylor@example.com&#39;</span><span class="p">);</span>
<a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasCc</span><span class="p">(</span><span class="s1">&#39;abigail@example.com&#39;</span><span class="p">);</span>
<a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasBcc</span><span class="p">(</span><span class="s1">&#39;victoria@example.com&#39;</span><span class="p">);</span>
<a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasReplyTo</span><span class="p">(</span><span class="s1">&#39;tyler@example.com&#39;</span><span class="p">);</span>
<a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasSubject</span><span class="p">(</span><span class="s1">&#39;Invoice Paid&#39;</span><span class="p">);</span>
<a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasTag</span><span class="p">(</span><span class="s1">&#39;example-tag&#39;</span><span class="p">);</span>
<a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasMetadata</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">);</span>
<a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a>
<a id="__codelineno-33-18" name="__codelineno-33-18" href="#__codelineno-33-18"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertSeeInHtml</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">email</span><span class="p">);</span>
<a id="__codelineno-33-19" name="__codelineno-33-19" href="#__codelineno-33-19"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertSeeInHtml</span><span class="p">(</span><span class="s1">&#39;Invoice Paid&#39;</span><span class="p">);</span>
<a id="__codelineno-33-20" name="__codelineno-33-20" href="#__codelineno-33-20"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertSeeInOrderInHtml</span><span class="p">([</span><span class="s1">&#39;Invoice Paid&#39;</span><span class="p">,</span> <span class="s1">&#39;Thanks&#39;</span><span class="p">]);</span>
<a id="__codelineno-33-21" name="__codelineno-33-21" href="#__codelineno-33-21"></a>
<a id="__codelineno-33-22" name="__codelineno-33-22" href="#__codelineno-33-22"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertSeeInText</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">email</span><span class="p">);</span>
<a id="__codelineno-33-23" name="__codelineno-33-23" href="#__codelineno-33-23"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertSeeInOrderInText</span><span class="p">([</span><span class="s1">&#39;Invoice Paid&#39;</span><span class="p">,</span> <span class="s1">&#39;Thanks&#39;</span><span class="p">]);</span>
<a id="__codelineno-33-24" name="__codelineno-33-24" href="#__codelineno-33-24"></a>
<a id="__codelineno-33-25" name="__codelineno-33-25" href="#__codelineno-33-25"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasAttachment</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">);</span>
<a id="__codelineno-33-26" name="__codelineno-33-26" href="#__codelineno-33-26"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasAttachment</span><span class="p">(</span><span class="nx">Attachment</span><span class="o">::</span><span class="na">fromPath</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">));</span>
<a id="__codelineno-33-27" name="__codelineno-33-27" href="#__codelineno-33-27"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasAttachedData</span><span class="p">(</span><span class="nv">$pdfData</span><span class="p">,</span> <span class="s1">&#39;name.pdf&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mime&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;application/pdf&#39;</span><span class="p">]);</span>
<a id="__codelineno-33-28" name="__codelineno-33-28" href="#__codelineno-33-28"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasAttachmentFromStorage</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">,</span> <span class="s1">&#39;name.pdf&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mime&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;application/pdf&#39;</span><span class="p">]);</span>
<a id="__codelineno-33-29" name="__codelineno-33-29" href="#__codelineno-33-29"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasAttachmentFromStorageDisk</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/file&#39;</span><span class="p">,</span> <span class="s1">&#39;name.pdf&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mime&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;application/pdf&#39;</span><span class="p">]);</span>
<a id="__codelineno-33-30" name="__codelineno-33-30" href="#__codelineno-33-30"></a><span class="p">});</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">PHPUnit</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="k">use</span> <span class="nx">App\Mail\InvoicePaid</span><span class="p">;</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="k">use</span> <span class="nx">App\Models\User</span><span class="p">;</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="k">public</span> <span class="k">function</span> <span class="nf">test_mailable_content</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="p">{</span>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>    <span class="nv">$user</span> <span class="o">=</span> <span class="nx">User</span><span class="o">::</span><span class="na">factory</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">();</span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>    <span class="nv">$mailable</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">InvoicePaid</span><span class="p">(</span><span class="nv">$user</span><span class="p">);</span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertFrom</span><span class="p">(</span><span class="s1">&#39;jeffrey@example.com&#39;</span><span class="p">);</span>
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertTo</span><span class="p">(</span><span class="s1">&#39;taylor@example.com&#39;</span><span class="p">);</span>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasCc</span><span class="p">(</span><span class="s1">&#39;abigail@example.com&#39;</span><span class="p">);</span>
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasBcc</span><span class="p">(</span><span class="s1">&#39;victoria@example.com&#39;</span><span class="p">);</span>
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasReplyTo</span><span class="p">(</span><span class="s1">&#39;tyler@example.com&#39;</span><span class="p">);</span>
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasSubject</span><span class="p">(</span><span class="s1">&#39;Invoice Paid&#39;</span><span class="p">);</span>
<a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasTag</span><span class="p">(</span><span class="s1">&#39;example-tag&#39;</span><span class="p">);</span>
<a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasMetadata</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">);</span>
<a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a>
<a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertSeeInHtml</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">email</span><span class="p">);</span>
<a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertSeeInHtml</span><span class="p">(</span><span class="s1">&#39;Invoice Paid&#39;</span><span class="p">);</span>
<a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertSeeInOrderInHtml</span><span class="p">([</span><span class="s1">&#39;Invoice Paid&#39;</span><span class="p">,</span> <span class="s1">&#39;Thanks&#39;</span><span class="p">]);</span>
<a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a>
<a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertSeeInText</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">email</span><span class="p">);</span>
<a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertSeeInOrderInText</span><span class="p">([</span><span class="s1">&#39;Invoice Paid&#39;</span><span class="p">,</span> <span class="s1">&#39;Thanks&#39;</span><span class="p">]);</span>
<a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a>
<a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasAttachment</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">);</span>
<a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasAttachment</span><span class="p">(</span><span class="nx">Attachment</span><span class="o">::</span><span class="na">fromPath</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">));</span>
<a id="__codelineno-34-28" name="__codelineno-34-28" href="#__codelineno-34-28"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasAttachedData</span><span class="p">(</span><span class="nv">$pdfData</span><span class="p">,</span> <span class="s1">&#39;name.pdf&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mime&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;application/pdf&#39;</span><span class="p">]);</span>
<a id="__codelineno-34-29" name="__codelineno-34-29" href="#__codelineno-34-29"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasAttachmentFromStorage</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">,</span> <span class="s1">&#39;name.pdf&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mime&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;application/pdf&#39;</span><span class="p">]);</span>
<a id="__codelineno-34-30" name="__codelineno-34-30" href="#__codelineno-34-30"></a>    <span class="nv">$mailable</span><span class="o">-&gt;</span><span class="na">assertHasAttachmentFromStorageDisk</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/file&#39;</span><span class="p">,</span> <span class="s1">&#39;name.pdf&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mime&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;application/pdf&#39;</span><span class="p">]);</span>
<a id="__codelineno-34-31" name="__codelineno-34-31" href="#__codelineno-34-31"></a><span class="p">}</span>
</code></pre></div>
<p><a name="testing-mailable-sending"></a></p>
<h3 id="_38">メールの送信のテスト<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h3>
<p>メールの内容を別々にテストすることをお勧めします。特定のメールが特定のユーザーに「送信」されたことをアサートするテストとは別にテストします。通常、メールの内容はテストしているコードには関係ありません。Laravelに特定のメールを送信するよう指示されたことをアサートするだけで十分です。</p>
<p><code>Mail</code> ファサードの <code>fake</code> メソッドを使用して、メールが送信されないようにすることができます。<code>Mail</code> ファサードの <code>fake</code> メソッドを呼び出した後、メールがユーザーに送信されるように指示されたことをアサートし、メールが受け取ったデータを検査することもできます。</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Pest</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="o">&lt;?</span><span class="nx">php</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="k">use</span> <span class="nx">App\Mail\OrderShipped</span><span class="p">;</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="k">use</span> <span class="nx">Illuminate\Support\Facades\Mail</span><span class="p">;</span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="nx">test</span><span class="p">(</span><span class="s1">&#39;orders can be shipped&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>    <span class="nx">Mail</span><span class="o">::</span><span class="na">fake</span><span class="p">();</span>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>    <span class="c1">// 注文の発送を実行...</span>
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>    <span class="c1">// メールが送信されなかったことをアサート...</span>
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a>    <span class="nx">Mail</span><span class="o">::</span><span class="na">assertNothingSent</span><span class="p">();</span>
<a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>
<a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a>    <span class="c1">// メールが送信されたことをアサート...</span>
<a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a>    <span class="nx">Mail</span><span class="o">::</span><span class="na">assertSent</span><span class="p">(</span><span class="nx">OrderShipped</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a>
<a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a>    <span class="c1">// メールが2回送信されたことをアサート...</span>
<a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a>    <span class="nx">Mail</span><span class="o">::</span><span class="na">assertSent</span><span class="p">(</span><span class="nx">OrderShipped</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a>
<a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a>    <span class="c1">// メールがメールアドレスに送信されたことをアサート...</span>
<a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a>    <span class="nx">Mail</span><span class="o">::</span><span class="na">assertSent</span><span class="p">(</span><span class="nx">OrderShipped</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;example@laravel.com&#39;</span><span class="p">);</span>
<a id="__codelineno-35-22" name="__codelineno-35-22" href="#__codelineno-35-22"></a>
<a id="__codelineno-35-23" name="__codelineno-35-23" href="#__codelineno-35-23"></a>    <span class="c1">// メールが複数のメールアドレスに送信されたことをアサート...</span>
<a id="__codelineno-35-24" name="__codelineno-35-24" href="#__codelineno-35-24"></a>    <span class="nx">Mail</span><span class="o">::</span><span class="na">assertSent</span><span class="p">(</span><span class="nx">OrderShipped</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;example@laravel.com&#39;</span><span class="p">,</span> <span class="s1">&#39;...&#39;</span><span class="p">]);</span>
<a id="__codelineno-35-25" name="__codelineno-35-25" href="#__codelineno-35-25"></a>
<a id="__codelineno-35-26" name="__codelineno-35-26" href="#__codelineno-35-26"></a>    <span class="c1">// メールが送信されなかったことをアサート...</span>
<a id="__codelineno-35-27" name="__codelineno-35-27" href="#__codelineno-35-27"></a>    <span class="nx">Mail</span><span class="o">::</span><span class="na">assertNotSent</span><span class="p">(</span><span class="nx">AnotherMailable</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-35-28" name="__codelineno-35-28" href="#__codelineno-35-28"></a>
<a id="__codelineno-35-29" name="__codelineno-35-29" href="#__codelineno-35-29"></a>    <span class="c1">// 合計3通のメールが送信されたことをアサート...</span>
<a id="__codelineno-35-30" name="__codelineno-35-30" href="#__codelineno-35-30"></a>    <span class="nx">Mail</span><span class="o">::</span><span class="na">assertSentCount</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<a id="__codelineno-35-31" name="__codelineno-35-31" href="#__codelineno-35-31"></a><span class="p">});</span>
</code></pre></div>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">PHPUnit</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="o">&lt;?</span><span class="nx">php</span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="k">namespace</span> <span class="nx">Tests\Feature</span><span class="p">;</span>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="k">use</span> <span class="nx">App\Mail\OrderShipped</span><span class="p">;</span>
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="k">use</span> <span class="nx">Illuminate\Support\Facades\Mail</span><span class="p">;</span>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="k">use</span> <span class="nx">Tests\TestCase</span><span class="p">;</span>
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="k">class</span> <span class="nc">ExampleTest</span> <span class="k">extends</span> <span class="nx">TestCase</span>
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="p">{</span>
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a>    <span class="k">public</span> <span class="k">function</span> <span class="nf">test_orders_can_be_shipped</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>    <span class="p">{</span>
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>        <span class="nx">Mail</span><span class="o">::</span><span class="na">fake</span><span class="p">();</span>
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>
<a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a>        <span class="c1">// 注文の発送を実行...</span>
<a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a>
<a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a>        <span class="c1">// メールが送信されなかったことをアサート...</span>
<a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a>        <span class="nx">Mail</span><span class="o">::</span><span class="na">assertNothingSent</span><span class="p">();</span>
<a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a>
<a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a>        <span class="c1">// メールが送信されたことをアサート...</span>
<a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a>        <span class="nx">Mail</span><span class="o">::</span><span class="na">assertSent</span><span class="p">(</span><span class="nx">OrderShipped</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a>
<a id="__codelineno-36-23" name="__codelineno-36-23" href="#__codelineno-36-23"></a>        <span class="c1">// メールが2回送信されたことをアサート...</span>
<a id="__codelineno-36-24" name="__codelineno-36-24" href="#__codelineno-36-24"></a>        <span class="nx">Mail</span><span class="o">::</span><span class="na">assertSent</span><span class="p">(</span><span class="nx">OrderShipped</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<a id="__codelineno-36-25" name="__codelineno-36-25" href="#__codelineno-36-25"></a>
<a id="__codelineno-36-26" name="__codelineno-36-26" href="#__codelineno-36-26"></a>        <span class="c1">// メールがメールアドレスに送信されたことをアサート...</span>
<a id="__codelineno-36-27" name="__codelineno-36-27" href="#__codelineno-36-27"></a>        <span class="nx">Mail</span><span class="o">::</span><span class="na">assertSent</span><span class="p">(</span><span class="nx">OrderShipped</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="s1">&#39;example@laravel.com&#39;</span><span class="p">);</span>
<a id="__codelineno-36-28" name="__codelineno-36-28" href="#__codelineno-36-28"></a>
<a id="__codelineno-36-29" name="__codelineno-36-29" href="#__codelineno-36-29"></a>        <span class="c1">// メールが複数のメールアドレスに送信されたことをアサート...</span>
<a id="__codelineno-36-30" name="__codelineno-36-30" href="#__codelineno-36-30"></a>        <span class="nx">Mail</span><span class="o">::</span><span class="na">assertSent</span><span class="p">(</span><span class="nx">OrderShipped</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;example@laravel.com&#39;</span><span class="p">,</span> <span class="s1">&#39;...&#39;</span><span class="p">]);</span>
<a id="__codelineno-36-31" name="__codelineno-36-31" href="#__codelineno-36-31"></a>
<a id="__codelineno-36-32" name="__codelineno-36-32" href="#__codelineno-36-32"></a>        <span class="c1">// メールが送信されなかったことをアサート...</span>
<a id="__codelineno-36-33" name="__codelineno-36-33" href="#__codelineno-36-33"></a>        <span class="nx">Mail</span><span class="o">::</span><span class="na">assertNotSent</span><span class="p">(</span><span class="nx">AnotherMailable</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-36-34" name="__codelineno-36-34" href="#__codelineno-36-34"></a>
<a id="__codelineno-36-35" name="__codelineno-36-35" href="#__codelineno-36-35"></a>        <span class="c1">// 合計3通のメールが送信されたことをアサート...</span>
<a id="__codelineno-36-36" name="__codelineno-36-36" href="#__codelineno-36-36"></a>        <span class="nx">Mail</span><span class="o">::</span><span class="na">assertSentCount</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<a id="__codelineno-36-37" name="__codelineno-36-37" href="#__codelineno-36-37"></a>    <span class="p">}</span>
<a id="__codelineno-36-38" name="__codelineno-36-38" href="#__codelineno-36-38"></a><span class="p">}</span>
</code></pre></div>
<p>メールをバックグラウンドで配信するためにキューに入れている場合は、<code>assertSent</code>の代わりに<code>assertQueued</code>メソッドを使用する必要があります。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="nx">Mail</span><span class="o">::</span><span class="na">assertQueued</span><span class="p">(</span><span class="nx">OrderShipped</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="nx">Mail</span><span class="o">::</span><span class="na">assertNotQueued</span><span class="p">(</span><span class="nx">OrderShipped</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="nx">Mail</span><span class="o">::</span><span class="na">assertNothingQueued</span><span class="p">();</span>
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="nx">Mail</span><span class="o">::</span><span class="na">assertQueuedCount</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
</code></pre></div>
<p><code>assertSent</code>、<code>assertNotSent</code>、<code>assertQueued</code>、または<code>assertNotQueued</code>メソッドにクロージャを渡して、特定の「真実テスト」をパスするメールが送信されたことをアサートすることができます。少なくとも1通のメールが指定された真実テストをパスした場合、アサーションは成功します。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="nx">Mail</span><span class="o">::</span><span class="na">assertSent</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nx">OrderShipped</span> <span class="nv">$mail</span><span class="p">)</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$order</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>    <span class="k">return</span> <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">order</span><span class="o">-&gt;</span><span class="na">id</span> <span class="o">===</span> <span class="nv">$order</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">;</span>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="p">});</span>
</code></pre></div>
<p><code>Mail</code>ファサードのアサーションメソッドを呼び出す際、提供されたクロージャによって受け入れられるメールインスタンスは、メールを調査するための便利なメソッドを公開しています。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="nx">Mail</span><span class="o">::</span><span class="na">assertSent</span><span class="p">(</span><span class="nx">OrderShipped</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">OrderShipped</span> <span class="nv">$mail</span><span class="p">)</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$user</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>    <span class="k">return</span> <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">hasTo</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">email</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>           <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">hasCc</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>           <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">hasBcc</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>           <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">hasReplyTo</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
<a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>           <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">hasFrom</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
<a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a>           <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">hasSubject</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="p">);</span>
<a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="p">});</span>
</code></pre></div>
<p>メールインスタンスには、メールに添付されたファイルを調査するためのいくつかの便利なメソッドも含まれています。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="k">use</span> <span class="nx">Illuminate\Mail\Mailables\Attachment</span><span class="p">;</span>
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="nx">Mail</span><span class="o">::</span><span class="na">assertSent</span><span class="p">(</span><span class="nx">OrderShipped</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">OrderShipped</span> <span class="nv">$mail</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>    <span class="k">return</span> <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">hasAttachment</span><span class="p">(</span>
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a>        <span class="nx">Attachment</span><span class="o">::</span><span class="na">fromPath</span><span class="p">(</span><span class="s1">&#39;/path/to/file&#39;</span><span class="p">)</span>
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a>                <span class="o">-&gt;</span><span class="na">as</span><span class="p">(</span><span class="s1">&#39;name.pdf&#39;</span><span class="p">)</span>
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a>                <span class="o">-&gt;</span><span class="na">withMime</span><span class="p">(</span><span class="s1">&#39;application/pdf&#39;</span><span class="p">)</span>
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a>    <span class="p">);</span>
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a><span class="p">});</span>
<a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a>
<a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a><span class="nx">Mail</span><span class="o">::</span><span class="na">assertSent</span><span class="p">(</span><span class="nx">OrderShipped</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">OrderShipped</span> <span class="nv">$mail</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a>    <span class="k">return</span> <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">hasAttachment</span><span class="p">(</span>
<a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a>        <span class="nx">Attachment</span><span class="o">::</span><span class="na">fromStorageDisk</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/file&#39;</span><span class="p">)</span>
<a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a>    <span class="p">);</span>
<a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a><span class="p">});</span>
<a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a>
<a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a><span class="nx">Mail</span><span class="o">::</span><span class="na">assertSent</span><span class="p">(</span><span class="nx">OrderShipped</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">OrderShipped</span> <span class="nv">$mail</span><span class="p">)</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$pdfData</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-40-18" name="__codelineno-40-18" href="#__codelineno-40-18"></a>    <span class="k">return</span> <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">hasAttachment</span><span class="p">(</span>
<a id="__codelineno-40-19" name="__codelineno-40-19" href="#__codelineno-40-19"></a>        <span class="nx">Attachment</span><span class="o">::</span><span class="na">fromData</span><span class="p">(</span><span class="nx">fn</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nv">$pdfData</span><span class="p">,</span> <span class="s1">&#39;name.pdf&#39;</span><span class="p">)</span>
<a id="__codelineno-40-20" name="__codelineno-40-20" href="#__codelineno-40-20"></a>    <span class="p">);</span>
<a id="__codelineno-40-21" name="__codelineno-40-21" href="#__codelineno-40-21"></a><span class="p">});</span>
</code></pre></div>
<p>メールが送信されなかったことをアサートするための2つのメソッド、<code>assertNotSent</code>と<code>assertNotQueued</code>があることに気づいたかもしれません。時には、メールが送信<strong>または</strong>キューに入れられなかったことをアサートしたい場合があります。これを実現するために、<code>assertNothingOutgoing</code>と<code>assertNotOutgoing</code>メソッドを使用できます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="nx">Mail</span><span class="o">::</span><span class="na">assertNothingOutgoing</span><span class="p">();</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="nx">Mail</span><span class="o">::</span><span class="na">assertNotOutgoing</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nx">OrderShipped</span> <span class="nv">$mail</span><span class="p">)</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$order</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>    <span class="k">return</span> <span class="nv">$mail</span><span class="o">-&gt;</span><span class="na">order</span><span class="o">-&gt;</span><span class="na">id</span> <span class="o">===</span> <span class="nv">$order</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">;</span>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="p">});</span>
</code></pre></div>
<p><a name="mail-and-local-development"></a></p>
<h2 id="_39">メールとローカル開発<a class="headerlink" href="#_39" title="Permanent link">&para;</a></h2>
<p>メールを送信するアプリケーションを開発する際、実際のメールアドレスにメールを送信したくない場合があります。Laravelは、ローカル開発中にメールの実際の送信を「無効化」するいくつかの方法を提供しています。</p>
<p><a name="log-driver"></a></p>
<h4 id="_40">ログドライバ<a class="headerlink" href="#_40" title="Permanent link">&para;</a></h4>
<p>メールの代わりに、<code>log</code>メールドライバはすべてのメールメッセージをログファイルに書き込みます。通常、このドライバはローカル開発中にのみ使用されます。環境ごとにアプリケーションを設定する方法の詳細については、<a href="configuration.html#environment-configuration">設定ドキュメント</a>を確認してください。</p>
<p><a name="mailtrap"></a></p>
<h4 id="helo-mailtrap-mailpit">HELO / Mailtrap / Mailpit<a class="headerlink" href="#helo-mailtrap-mailpit" title="Permanent link">&para;</a></h4>
<p>または、<a href="https://usehelo.com">HELO</a>や<a href="https://mailtrap.io">Mailtrap</a>のようなサービスと<code>smtp</code>ドライバを使用して、メールメッセージを「ダミー」のメールボックスに送信し、真のメールクライアントで表示することもできます。このアプローチには、Mailtrapのメッセージビューアで実際のメールを確認できるという利点があります。</p>
<p><a href="sail.html">Laravel Sail</a>を使用している場合、<a href="https://github.com/axllent/mailpit">Mailpit</a>を使用してメッセージをプレビューできます。Sailが実行中の場合、Mailpitインターフェースには以下のURLからアクセスできます: <code>http://localhost:8025</code>。</p>
<p><a name="using-a-global-to-address"></a></p>
<h4 id="to">グローバルな<code>to</code>アドレスの使用<a class="headerlink" href="#to" title="Permanent link">&para;</a></h4>
<p>最後に、<code>Mail</code>ファサードが提供する<code>alwaysTo</code>メソッドを呼び出して、グローバルな「to」アドレスを指定することができます。通常、このメソッドはアプリケーションのサービスプロバイダの<code>boot</code>メソッドから呼び出す必要があります。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="k">use</span> <span class="nx">Illuminate\Support\Facades\Mail</span><span class="p">;</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="sd">/**</span>
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="sd"> * 任意のアプリケーションサービスをブートストラップします。</span>
<a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="sd"> */</span>
<a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="k">public</span> <span class="k">function</span> <span class="nf">boot</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
<a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="p">{</span>
<a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a>    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">app</span><span class="o">-&gt;</span><span class="na">environment</span><span class="p">(</span><span class="s1">&#39;local&#39;</span><span class="p">))</span> <span class="p">{</span>
<a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a>        <span class="nx">Mail</span><span class="o">::</span><span class="na">alwaysTo</span><span class="p">(</span><span class="s1">&#39;taylor@example.com&#39;</span><span class="p">);</span>
<a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a>    <span class="p">}</span>
<a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a><span class="p">}</span>
</code></pre></div>
<p><a name="events"></a></p>
<h2 id="_41">イベント<a class="headerlink" href="#_41" title="Permanent link">&para;</a></h2>
<p>Laravelは、メールメッセージを送信する際に2つのイベントをディスパッチします。<code>MessageSending</code>イベントはメッセージが送信される前にディスパッチされ、<code>MessageSent</code>イベントはメッセージが送信された後にディスパッチされます。これらのイベントは、メールが<em>送信</em>されるときにディスパッチされ、キューに入れられるときではありません。これらのイベントの<a href="events.html">イベントリスナー</a>をアプリケーション内で作成できます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="k">use</span> <span class="nx">Illuminate\Mail\Events\MessageSending</span><span class="p">;</span>
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="c1">// use Illuminate\Mail\Events\MessageSent;</span>
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>
<a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="k">class</span> <span class="nc">LogMessage</span>
<a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="p">{</span>
<a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a>    <span class="sd">/**</span>
<a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a><span class="sd">     * 指定されたイベントを処理します。</span>
<a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="sd">     */</span>
<a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a>    <span class="k">public</span> <span class="k">function</span> <span class="nf">handle</span><span class="p">(</span><span class="nx">MessageSending</span> <span class="nv">$event</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span>
<a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a>    <span class="p">{</span>
<a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a>        <span class="c1">// ...</span>
<a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a>    <span class="p">}</span>
<a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a><span class="p">}</span>
</code></pre></div>
<p><a name="custom-transports"></a></p>
<h2 id="_42">カスタムトランスポート<a class="headerlink" href="#_42" title="Permanent link">&para;</a></h2>
<p>Laravelにはさまざまなメールトランスポートが含まれていますが、Laravelがデフォルトでサポートしていない他のサービスを介してメールを送信するために独自のトランスポートを作成したい場合があります。これを実現するために、<code>Symfony\Component\Mailer\Transport\AbstractTransport</code>クラスを拡張するクラスを定義します。次に、トランスポートの<code>doSend</code>メソッドと<code>__toString()</code>メソッドを実装します。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="k">use</span> <span class="nx">MailchimpTransactional\ApiClient</span><span class="p">;</span>
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="k">use</span> <span class="nx">Symfony\Component\Mailer\SentMessage</span><span class="p">;</span>
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="k">use</span> <span class="nx">Symfony\Component\Mailer\Transport\AbstractTransport</span><span class="p">;</span>
<a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="k">use</span> <span class="nx">Symfony\Component\Mime\Address</span><span class="p">;</span>
<a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="k">use</span> <span class="nx">Symfony\Component\Mime\MessageConverter</span><span class="p">;</span>
<a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a>
<a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="k">class</span> <span class="nc">MailchimpTransport</span> <span class="k">extends</span> <span class="nx">AbstractTransport</span>
<a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="p">{</span>
<a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a>    <span class="sd">/**</span>
<a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a><span class="sd">     * 新しいMailchimpトランスポートインスタンスを作成します。</span>
<a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a><span class="sd">     */</span>
<a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span>
<a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a>        <span class="k">protected</span> <span class="nx">ApiClient</span> <span class="nv">$client</span><span class="p">,</span>
<a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a>    <span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a>        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">();</span>
<a id="__codelineno-44-16" name="__codelineno-44-16" href="#__codelineno-44-16"></a>    <span class="p">}</span>
<a id="__codelineno-44-17" name="__codelineno-44-17" href="#__codelineno-44-17"></a>
<a id="__codelineno-44-18" name="__codelineno-44-18" href="#__codelineno-44-18"></a>    <span class="sd">/**</span>
<a id="__codelineno-44-19" name="__codelineno-44-19" href="#__codelineno-44-19"></a><span class="sd">     * {@inheritDoc}</span>
<a id="__codelineno-44-20" name="__codelineno-44-20" href="#__codelineno-44-20"></a><span class="sd">     */</span>
<a id="__codelineno-44-21" name="__codelineno-44-21" href="#__codelineno-44-21"></a>    <span class="k">protected</span> <span class="k">function</span> <span class="nf">doSend</span><span class="p">(</span><span class="nx">SentMessage</span> <span class="nv">$message</span><span class="p">)</span><span class="o">:</span> <span class="nx">void</span>
<a id="__codelineno-44-22" name="__codelineno-44-22" href="#__codelineno-44-22"></a>    <span class="p">{</span>
<a id="__codelineno-44-23" name="__codelineno-44-23" href="#__codelineno-44-23"></a>        <span class="nv">$email</span> <span class="o">=</span> <span class="nx">MessageConverter</span><span class="o">::</span><span class="na">toEmail</span><span class="p">(</span><span class="nv">$message</span><span class="o">-&gt;</span><span class="na">getOriginalMessage</span><span class="p">());</span>
<a id="__codelineno-44-24" name="__codelineno-44-24" href="#__codelineno-44-24"></a>
<a id="__codelineno-44-25" name="__codelineno-44-25" href="#__codelineno-44-25"></a>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">client</span><span class="o">-&gt;</span><span class="na">messages</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">([</span><span class="s1">&#39;message&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<a id="__codelineno-44-26" name="__codelineno-44-26" href="#__codelineno-44-26"></a>            <span class="s1">&#39;from_email&#39;</span> <span class="o">=&gt;</span> <span class="nv">$email</span><span class="o">-&gt;</span><span class="na">getFrom</span><span class="p">(),</span>
<a id="__codelineno-44-27" name="__codelineno-44-27" href="#__codelineno-44-27"></a>            <span class="s1">&#39;to&#39;</span> <span class="o">=&gt;</span> <span class="nx">collect</span><span class="p">(</span><span class="nv">$email</span><span class="o">-&gt;</span><span class="na">getTo</span><span class="p">())</span><span class="o">-&gt;</span><span class="na">map</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nx">Address</span> <span class="nv">$email</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-44-28" name="__codelineno-44-28" href="#__codelineno-44-28"></a>                <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="nv">$email</span><span class="o">-&gt;</span><span class="na">getAddress</span><span class="p">(),</span> <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;to&#39;</span><span class="p">];</span>
<a id="__codelineno-44-29" name="__codelineno-44-29" href="#__codelineno-44-29"></a>            <span class="p">})</span><span class="o">-&gt;</span><span class="na">all</span><span class="p">(),</span>
<a id="__codelineno-44-30" name="__codelineno-44-30" href="#__codelineno-44-30"></a>            <span class="s1">&#39;subject&#39;</span> <span class="o">=&gt;</span> <span class="nv">$email</span><span class="o">-&gt;</span><span class="na">getSubject</span><span class="p">(),</span>
<a id="__codelineno-44-31" name="__codelineno-44-31" href="#__codelineno-44-31"></a>            <span class="s1">&#39;text&#39;</span> <span class="o">=&gt;</span> <span class="nv">$email</span><span class="o">-&gt;</span><span class="na">getTextBody</span><span class="p">(),</span>
<a id="__codelineno-44-32" name="__codelineno-44-32" href="#__codelineno-44-32"></a>        <span class="p">]]);</span>
<a id="__codelineno-44-33" name="__codelineno-44-33" href="#__codelineno-44-33"></a>    <span class="p">}</span>
<a id="__codelineno-44-34" name="__codelineno-44-34" href="#__codelineno-44-34"></a>
<a id="__codelineno-44-35" name="__codelineno-44-35" href="#__codelineno-44-35"></a>    <span class="sd">/**</span>
<a id="__codelineno-44-36" name="__codelineno-44-36" href="#__codelineno-44-36"></a><span class="sd">     * トランスポートの文字列表現を取得します。</span>
<a id="__codelineno-44-37" name="__codelineno-44-37" href="#__codelineno-44-37"></a><span class="sd">     */</span>
<a id="__codelineno-44-38" name="__codelineno-44-38" href="#__codelineno-44-38"></a>    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">()</span><span class="o">:</span> <span class="nx">string</span>
<a id="__codelineno-44-39" name="__codelineno-44-39" href="#__codelineno-44-39"></a>    <span class="p">{</span>
<a id="__codelineno-44-40" name="__codelineno-44-40" href="#__codelineno-44-40"></a>        <span class="k">return</span> <span class="s1">&#39;mailchimp&#39;</span><span class="p">;</span>
<a id="__codelineno-44-41" name="__codelineno-44-41" href="#__codelineno-44-41"></a>    <span class="p">}</span>
<a id="__codelineno-44-42" name="__codelineno-44-42" href="#__codelineno-44-42"></a><span class="p">}</span>
</code></pre></div>
<p>カスタムトランスポートを定義したら、<code>Mail</code>ファサードが提供する<code>extend</code>メソッドを介して登録できます。通常、これはアプリケーションの<code>AppServiceProvider</code>サービスプロバイダの<code>boot</code>メソッド内で行う必要があります。<code>extend</code>メソッドに提供されるクロージャには、アプリケーションの<code>config/mail.php</code>設定ファイルでメーラーに対して定義された設定配列を含む<code>$config</code>引数が渡されます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="k">use</span> <span class="nx">App\Mail\MailchimpTransport</span><span class="p">;</span>
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="k">use</span> <span class="nx">Illuminate\Support\Facades\Mail</span><span class="p">;</span>
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="sd">/**</span>
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="sd"> * 任意のアプリケーションサービスをブートストラップします。</span>
<a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a><span class="sd"> */</span>
<a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="k">public</span> <span class="k">function</span> <span class="nf">boot</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
<a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a><span class="p">{</span>
<a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a>    <span class="nx">Mail</span><span class="o">::</span><span class="na">extend</span><span class="p">(</span><span class="s1">&#39;mailchimp&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="k">array</span> <span class="nv">$config</span> <span class="o">=</span> <span class="p">[])</span> <span class="p">{</span>
<a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a>        <span class="k">return</span> <span class="k">new</span> <span class="nx">MailchimpTransport</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">);</span>
<a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a>    <span class="p">});</span>
<a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a><span class="p">}</span>
</code></pre></div>
<p>カスタムトランスポートを定義して登録したら、アプリケーションの<code>config/mail.php</code>設定ファイル内に新しいトランスポートを使用するメーラー定義を作成できます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="s1">&#39;mailchimp&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>    <span class="s1">&#39;transport&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mailchimp&#39;</span><span class="p">,</span>
<a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>    <span class="c1">// ...</span>
<a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="p">],</span>
</code></pre></div>
<p><a name="additional-symfony-transports"></a></p>
<h3 id="symfony_1">追加のSymfonyトランスポート<a class="headerlink" href="#symfony_1" title="Permanent link">&para;</a></h3>
<p>Laravelは、MailgunやPostmarkなどの既存のSymfony管理のメールトランスポートをサポートしています。ただし、Laravelを追加のSymfony管理のトランスポートで拡張したい場合があります。これを行うには、必要なSymfonyメーラーをComposerでインストールし、Laravelにトランスポートを登録します。例えば、「Brevo」（旧「Sendinblue」）Symfonyメーラーをインストールして登録します。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="x">composer require symfony/brevo-mailer symfony/http-client</span>
</code></pre></div>
<p>Brevoメーラーパッケージをインストールしたら、アプリケーションの<code>services</code>設定ファイルにBrevo API資格情報のエントリを追加します。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="s1">&#39;brevo&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>    <span class="s1">&#39;key&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;your-api-key&#39;</span><span class="p">,</span>
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="p">],</span>
</code></pre></div>
<p>次に、<code>Mail</code>ファサードの<code>extend</code>メソッドを使用して、Laravelにトランスポートを登録します。通常、これはサービスプロバイダの<code>boot</code>メソッド内で行う必要があります。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="k">use</span> <span class="nx">Illuminate\Support\Facades\Mail</span><span class="p">;</span>
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="k">use</span> <span class="nx">Symfony\Component\Mailer\Bridge\Brevo\Transport\BrevoTransportFactory</span><span class="p">;</span>
<a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="k">use</span> <span class="nx">Symfony\Component\Mailer\Transport\Dsn</span><span class="p">;</span>
<a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a>
<a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="sd">/**</span>
<a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="sd"> * 任意のアプリケーションサービスをブートストラップします。</span>
<a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a><span class="sd"> */</span>
<a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a><span class="k">public</span> <span class="k">function</span> <span class="nf">boot</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
<a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a><span class="p">{</span>
<a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a>    <span class="nx">Mail</span><span class="o">::</span><span class="na">extend</span><span class="p">(</span><span class="s1">&#39;brevo&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
<a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a>        <span class="k">return</span> <span class="p">(</span><span class="k">new</span> <span class="nx">BrevoTransportFactory</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span>
<a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a>            <span class="k">new</span> <span class="nx">Dsn</span><span class="p">(</span>
<a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a>                <span class="s1">&#39;brevo+api&#39;</span><span class="p">,</span>
<a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a>                <span class="s1">&#39;default&#39;</span><span class="p">,</span>
<a id="__codelineno-49-15" name="__codelineno-49-15" href="#__codelineno-49-15"></a>                <span class="nx">config</span><span class="p">(</span><span class="s1">&#39;services.brevo.key&#39;</span><span class="p">)</span>
<a id="__codelineno-49-16" name="__codelineno-49-16" href="#__codelineno-49-16"></a>            <span class="p">)</span>
<a id="__codelineno-49-17" name="__codelineno-49-17" href="#__codelineno-49-17"></a>        <span class="p">);</span>
<a id="__codelineno-49-18" name="__codelineno-49-18" href="#__codelineno-49-18"></a>    <span class="p">});</span>
<a id="__codelineno-49-19" name="__codelineno-49-19" href="#__codelineno-49-19"></a><span class="p">}</span>
</code></pre></div>
<p>トランスポートを登録したら、アプリケーションの<code>config/mail.php</code>設定ファイル内に新しいトランスポートを使用するメーラー定義を作成できます。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="s1">&#39;brevo&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>    <span class="s1">&#39;transport&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;brevo&#39;</span><span class="p">,</span>
<a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>    <span class="c1">// ...</span>
<a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="p">],</span>
</code></pre></div>









  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
<nav class="md-footer-nav">
    
    
</nav>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["back-to-top", "navigation.expand", "navigation.tabs", "navigation.footer", "navigation.sections", "navigation.expand", "content.code.copy", "hide_repository_button", "content.code.annotate", "content.tabs.link", "toc.none", "content.action.edit"], "search": "assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>